#!/bin/bash
################################## !!! README !!! #######################################
#                                                                                       #
# Script name: vdr_2.6.1_installer                                                      #
# Version: 2.6.1 Repository Master (https://github.com/fiveten59/Vdr_installer)        #
# Tested on Ubuntu 20.04                                                      #
# chmod the script                                                                      #
# then load it simply typing: sudo ./vdr_2.6.1_installer                                #
#                                                                                       #
#########################################################################################
#
PLUGIN="--lirc -P'dvbapi' -P'epgsearch' -P'skindesigner -l /etc/vdr/logos/ -i /etc/vdr/plugins/skindesigner/skins/' -P'iptv' -P'skinnopacity -l /etc/vdr/logos/' -P'radio -l /etc/vdr/plugins/radio/radio-OnAir1080.mpg' -P'channelscan' -P'systeminfo'"
#
#
ETC='/usr/local/etc'
SRC='/usr/local/src'
SRCVDR='/usr/local/src/vdr-2.6.1'
VDRSRC=''$SRC'/vdr/PLUGINS/src'
LIB='/usr/lib/vdr/plugins'
VDR='vdr-2.6.1'
PACKAGES="/usr/local/src/packages"
TEMP='/tmp'
SKINS='/etc/vdr/plugins/skindesigner/skins/'
SHARE='/usr/share/vdr/plugins'
PLUGINS='/etc/vdr/plugins'
Remind3='is already installed'
Remind4='are already installed'
Remind5='is not installed'
ALLOWED="#
# allowed_hosts.conf  This file describes a number of host addresses that
#                     are allowed to connect to the streamdev/vn****rver/xvdr/xineliboutput server running
#                     with the Video Disk Recorder (VDR) on this system.
# Syntax:
#
# IP-Address[/Netmask]
#
127.0.0.1             # always accept localhost
192.168.1.0/24        # any host on the local net
192.168.0.0/24        # any host on the local net
#204.152.189.113      # a specific host
#0.0.0.0/0            # any host on any net (USE THIS WITH CARE!)
#
#
# If your network setup is correct pls don't touch
# exit with CTRL+X
#
# If your network setup is diiferent change it and
# Save it with CTRL+O and exit with CTRL+X "
#
#               Disecq
#
TRIAL="# Full DiSEqC sequence:
# 9 - 13 - 19.2E
S9E  11700 V  9750 t v W15 [E0 10 38 F0] W15 A W15 T
S9E  99999 V 10600 t v W15 [E0 10 38 F1] W15 A W15 T
S9E  11700 H  9750 t V W15 [E0 10 38 F2] W15 A W15 T
S9E  99999 H 10600 t V W15 [E0 10 38 F3] W15 A W15 T

S13.0E 11700 V  9750 t v W15 [E0 10 38 F4] W15 B W15 t
S13.0E 99999 V 10600 t v W15 [E0 10 38 F5] W15 B W15 T
S13.0E 11700 H  9750 t V W15 [E0 10 38 F6] W15 B W15 t
S13.0E 99999 H 10600 t V W15 [E0 10 38 F7] W15 B W15 T

S19.2E 11700 V  9750 t v W15 [E0 10 38 F8] W15 A W15 t
S19.2E 99999 V 10600 t v W15 [E0 10 38 F9] W15 A W15 T
S19.2E 11700 H  9750 t V W15 [E0 10 38 FA] W15 A W15 t
S19.2E 99999 H 10600 t V W15 [E0 10 38 FB] W15 A W15 T
#
"
DUAL="#
# Full DiSEqC sequence:
# 13 - 19.2E
S13.0E 11700 V  9750  t v W15 [E0 10 38 F0] W15 A W15 t
S13.0E 99999 V 10600  t v W15 [E0 10 38 F1] W15 A W15 T
S13.0E 11700 H  9750  t V W15 [E0 10 38 F2] W15 A W15 t
S13.0E 99999 H 10600  t V W15 [E0 10 38 F3] W15 A W15 T

S19.2E  11700 V  9750  t v W15 [E0 10 38 F4] W15 B W15 t
S19.2E  99999 V 10600  t v W15 [E0 10 38 F5] W15 B W15 T
S19.2E  11700 H  9750  t V W15 [E0 10 38 F6] W15 B W15 t
S19.2E  99999 H 10600  t V W15 [E0 10 38 F7] W15 B W15 T
#
"
MONO5E="#
# Full DiSEqC sequence:
# Astra 4 - 4.8°E
S4.8E 11700 V  9750  t v W15 [E0 10 38 F0] W15 A W15 t
S4.8E 99999 V 10600  t v W15 [E0 10 38 F1] W15 A W15 T
S4.8E 11700 H  9750  t V W15 [E0 10 38 F2] W15 A W15 t
S4.8E 99999 H 10600  t V W15 [E0 10 38 F3] W15 A W15 T
#
"
MONO9="#
# Full DiSEqC sequence:
# Eutelsat 9 - 9.0°E
S9.0E 11700 V  9750  t v W15 [E0 10 38 F0] W15 A W15 t
S9.0E 99999 V 10600  t v W15 [E0 10 38 F1] W15 A W15 T
S9.0E 11700 H  9750  t V W15 [E0 10 38 F2] W15 A W15 t
S9.0E 99999 H 10600  t V W15 [E0 10 38 F3] W15 A W15 T
#
"
MONO13="#
# Full DiSEqC sequence:
# Hotbird - 13.0°E
S13.0E 11700 V  9750  t v W15 [E0 10 38 F0] W15 A W15 t
S13.0E 99999 V 10600  t v W15 [E0 10 38 F1] W15 A W15 T
S13.0E 11700 H  9750  t V W15 [E0 10 38 F2] W15 A W15 t
S13.0E 99999 H 10600  t V W15 [E0 10 38 F3] W15 A W15 T
#
"
MONO19="#
# Full DiSEqC sequence:
# Astra 19 - 19.2°E
S19.2E 11700 V  9750  t v W15 [E0 10 38 F0] W15 A W15 t
S19.2E 99999 V 10600  t v W15 [E0 10 38 F1] W15 A W15 T
S19.2E 11700 H  9750  t V W15 [E0 10 38 F2] W15 A W15 t
S19.2E 99999 H 10600  t V W15 [E0 10 38 F3] W15 A W15 T
#
"
MONO23="#
# Full DiSEqC sequence:
# Astra 23 - 23°E
S23.0E 11700 V  9750  t v W15 [E0 10 38 F0] W15 A W15 t
S23.0E 99999 V 10600  t v W15 [E0 10 38 F1] W15 A W15 T
S23.0E 11700 H  9750  t V W15 [E0 10 38 F2] W15 A W15 t
S23.0E 99999 H 10600  t V W15 [E0 10 38 F3] W15 A W15 T
#
"
MONO28="#
# Full DiSEqC sequence:
# Astra 28 - 28.2°E
S28.2E 11700 V  9750  t v W15 [E0 10 38 F0] W15 A W15 t
S28.2E 99999 V 10600  t v W15 [E0 10 38 F1] W15 A W15 T
S28.2E 11700 H  9750  t V W15 [E0 10 38 F2] W15 A W15 t
S28.2E 99999 H 10600  t V W15 [E0 10 38 F3] W15 A W15 T
#
"
MONO42="#
# Full DiSEqC sequence:
# Turksat - 42°E
S42.0E 11700 V  9750  t v W15 [E0 10 38 F0] W15 A W15 t
S42.0E 99999 V 10600  t v W15 [E0 10 38 F1] W15 A W15 T
S42.0E 11700 H  9750  t V W15 [E0 10 38 F2] W15 A W15 t
S42.0E 99999 H 10600  t V W15 [E0 10 38 F3] W15 A W15 T
#
"
MONO08W="#
# Full DiSEqC sequence:
# Thor - 0.8°W
S0.8W 11700 V  9750  t v W15 [E0 10 38 F0] W15 A W15 t
S0.8W  99999 V 10600  t v W15 [E0 10 38 F1] W15 A W15 T
S0.8W  11700 H  9750  t V W15 [E0 10 38 F2] W15 A W15 t
S0.8W  99999 H 10600  t V W15 [E0 10 38 F3] W15 A W15 T
#
"
MONO5W="#
# Full DiSEqC sequence:
# Eutelsat 5 - 5°W
S5.0W 11700 V  9750  t v W15 [E0 10 38 F0] W15 A W15 t
S5.0W 99999 V 10600  t v W15 [E0 10 38 F1] W15 A W15 T
S5.0W 11700 H  9750  t V W15 [E0 10 38 F2] W15 A W15 t
S5.0W 99999 H 10600  t V W15 [E0 10 38 F3] W15 A W15 T
#
"
MONO30W="#
# Full DiSEqC sequence:
# Hispasat - 30°W
S30.0W 11700 V  9750  t v W15 [E0 10 38 F0] W15 A W15 t
S30.0W 99999 V 10600  t v W15 [E0 10 38 F1] W15 A W15 T
S30.0W 11700 H  9750  t V W15 [E0 10 38 F2] W15 A W15 t
S30.0W 99999 H 10600  t V W15 [E0 10 38 F3] W15 A W15 T
#
"
#
apt-get -y install dialog git cvs wget checkinstall yasm mercurial unzip
apt-get -y install autoconf autopoint automake build-essential cmake libtool
apt-get -y install libxcb1-dev libxcb-shm0-dev libxcb-xfixes0-dev  pkg-config texinfo
    #
    exit_status_check()
    {
    if [ $? -ne 0 ]; then
    echo "Install did not run successfully"
    echo "                    Press Enter to continue ...               "
    read enterKey
    exit 1
   else
   echo "Install successful"
    fi
    }

    press_enter()
    {
     echo "                    Press Enter to continue ...               ";
     read enterKey
     exit 0
    }

    timer_start()
    {
    BEGIN=$(date +%s)
    }


    timer_stop()
    {
    NOW=$(date +%s)
    let DIFF=$(($NOW - $BEGIN))
    let MINS=$(($DIFF / 60))
    let SECS=$(($DIFF % 60))
    echo Time elapsed: $MINS:`printf %02d $SECS` >> $LOGFILE
    }

    line()
    {
    echo "-----------------------------------" >> $LOGFILE
    }
    # Make sure only root can run the script
    if [ "$(id -u)" != "0" ]; then
    echo "This script must be run as root" 1>&2
    exit 1
    fi

#############################################################


mkdir $SRC/packages
dialog --title " VDR 2.6.1 Installer " --infobox "Copyright (C) 2020

    This file is part of VDR Complete Installer (VCI).

    VCI is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    VCI is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with VCI. see the file VCI_License.GPL, If not see
    <http://www.gnu.org/licenses/>.


    A special thanks goes to Klaus Schmidinger Vdr Developer

    Script name: vdr_2.6.1_installer
    Version:2.6.1  (https:/github.com/fiveten59/Vdr_installer)
    Tested on Ubuntu 20.04
    chmod the script
    then load it simply typing: sudo ./vdr_2.6.1_installer " 0 0


echo "                    Press Enter to continue ...               "
read enterKey

#############################################################

clear
while :
do
echo ""
dialog --title "   ♦♦♦♦♦   VDR 2.6.1 Version Installer Script - Libraries & Codec  ♦♦♦♦♦   " --infobox "

	╭===========================================================================================╮
	|   ................♦♦♦   Download & Upgrade Local Repository   ♦♦♦.......................  |
	|   ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''  |
	|   [1]    +[Submenu] ~~  Local Repository Directory ~ Install - Upgrade  ~~ .............  |
	|   ======================================================================================= |
	|   ..........♦♦♦   Audio Video & Codec Libraries - Install & Uninstall  ♦♦♦..............  |
	|   ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''  |
	|   [2]    +[Submenu] ~~ Libs For Intel & Nvidia Devices   ...............................  |
	|   ======================================================================================= |
	|   .......................♦♦♦    VDR - Plugins - Skin    ♦♦♦.............................  |
	|   ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''  |
	|   [3]    +[Submenu] ~~  VDR & Plugins ..................................................  |
	|   ======================================================================================= |
	|   .......................♦♦♦    Channells Lists Setup    ♦♦♦............................  |
	|   ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''  |
	|   [4]    +[Submenu] ~~  Channells Lists ~ Install ~ Uninstall  .........................  |
	|   ======================================================================================= |
	|   .............................♦♦♦  KODI Setup  ♦♦♦.....................................  |
	|   ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''  |
	|   [5]    +[Submenu] ~~  Kodi Media Center ~ Install ~ Uninstall  .......................  |
	|   ======================================================================================= |
	|   .............................♦♦♦   Exit Setup Menu   ♦♦♦..............................  |
	|   [6]     Exit  ........................................................................  |
	╰===========================================================================================╯" 0 0

echo -n "              Enter your menu choice = Submenu [1~5] -- Exit [6] :        "
read yourch
case $yourch in

#############################################################

1)

cd /home/`logname`
mkdir -p Vdrrepo
chmod -R 777 Vdrrepo
cd Vdrrepo
clear
dialog --title "   ** Download & Upgrade Local Repository **   " --infobox "
   ---------------------------------------------------------------------------------------------
       Install ~ Upgrade ~ Remove ~ Local Repository
   ---------------------------------------------------------------------------------------------
        [a]  Install Intel Video devices libraries (If Not Exist)
        [b]  Install libs & progs for Vdr - Intel & Nvidia Video devices (If Not Exist)
        [c]  Remove & Upgrade all

        [z]  Skip

   ---------------------------------------------------------------------------------------------" 0 0
echo -n "        Enter your menu choice = Install [a-b]  ~~ Remove & Upgrade [c] ~~ Skip [z]:      "
read yourch
case $yourch in

a) clear

echo " Downloading Intel Video devices libraries on local repo "

if [ -e /home/`logname`/Vdrrepo/cmrt ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    git clone https://github.com/intel/cmrt
  fi

if [ -e /home/`logname`/Vdrrepo/libva ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    git clone https://github.com/intel/libva
  fi

if [ -e /home/`logname`/Vdrrepo/intel-hybrid-driver ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    git clone https://github.com/01org/intel-hybrid-driver
  fi

if [ -e /home/`logname`/Vdrrepo/intel-vaapi-driver ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    git clone https://github.com/intel/intel-vaapi-driver.git
  fi

if [ -e /home/`logname`/Vdrrepo/libva-utils ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    git clone https://github.com/intel/libva-utils
  fi;;

##############################################################

b) clear
echo " Downloading libs & progs for Vdr - Intel & Nvidia Video devices on local repo "

if [ -e /home/`logname`/Vdrrepo/ffmpeg-4.4.1.tar.bz2 ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://ffmpeg.org/releases/ffmpeg-4.4.1.tar.bz2
  fi

echo " Downloading Vdr and Plugins on local repo "

if [ -e /home/`logname`/Vdrrepo/2.6.1.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://github.com/vdr-projects/vdr/archive/refs/tags/2.6.1.tar.gz
  fi

if [ -e /home/`logname`/Vdrrepo/vdr-patches.2.6.1.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://www.dropbox.com/s/o87kvrdx3zocksm/vdr-patches.2.6.1.tar.gz
  fi

if [ -e /home/`logname`/Vdrrepo/Make.config.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://www.dropbox.com/s/qds2k91od7oboed/Make.config.tar.gz
  fi

if [ -e /home/`logname`/Vdrrepo/vdrsymbols.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://www.dropbox.com/s/bx97ikp7c1h2qj2/vdrsymbols.tar.gz
  fi

if [ -e /home/`logname`/Vdrrepo/vdr-plugin-dvbapi ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    git clone git://github.com/manio/vdr-plugin-dvbapi.git
  fi

if [ -e /home/`logname`/Vdrrepo/vdr-plugin-dvbapi ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    git clone git://github.com/manio/vdr-plugin-dvbapi.git
  fi

if [ -e /home/`logname`/Vdrrepo/vdr-plugin-epgsearch ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    git clone http://projects.vdr-developer.org/git/vdr-plugin-epgsearch.git
  fi

if [ -e /home/`logname`/Vdrrepo/patch_epgsearch.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://www.dropbox.com/s/s9vggu8mil8ss7t/patch_epgsearch.tar.gz
  fi

if [ -e /home/`logname`/Vdrrepo/vdr-plugin-iptv ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    git clone https://github.com/rofafor/vdr-plugin-iptv.git
  fi

if [ -e /home/`logname`/Vdrrepo/patch_iptv.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://www.dropbox.com/s/nof5ydmxrplw2b0/patch_iptv.tar.gz
fi

if [ -e /home/`logname`/Vdrrepo/iptv_conf.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://www.dropbox.com/s/vmhkf4rzhoh4wa5/iptv_conf.tar.gz
fi

if [ -e /home/`logname`/Vdrrepo/vdr-plugin-radio-master.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://www.dropbox.com/s/dv6okhltz3eu20i/vdr-plugin-radio-master.tar.gz
fi

if [ -e /home/`logname`/Vdrrepo/vdr-plugin-mpv ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    git clone https://github.com/ua0lnj/vdr-plugin-mpv.git
fi

if [ -e /home/`logname`/Vdrrepo/channelscan ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    git clone https://bitbucket.org/ua0lnj/channelscan.git
fi

if [ -e /home/`logname`/Vdrrepo/satellite_pack.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://www.dropbox.com/s/wm7c6nx4ymbcdk1/satellite_pack.tar.gz
fi

if [ -e /home/`logname`/Vdrrepo/vdr-systeminfo-0.1.5.tar.bz2 ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget http://firefly.vdr-developer.org/systeminfo/vdr-systeminfo-0.1.5.tar.bz2
fi

echo " Downloading skins "

if [ -e /home/`logname`/Vdrrepo/skindesigner ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
     git clone https://gitlab.com/kamel5/skindesigner.git
  fi

if [ -e /home/`logname`/Vdrrepo/SkinNopacity ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    git clone https://gitlab.com/kamel5/SkinNopacity.git
  fi

if [ -e /home/`logname`/Vdrrepo/logos ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    #wget https://www.dropbox.com/s/eeopbzh4gbyuir1/logos.tar.gz;
    git clone https://github.com/fiveten59/Logos.git logos
  fi

if [ -e /home/`logname`/Vdrrepo/icone.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://www.dropbox.com/s/5uvx468b4b87auy/icone.tar.gz
  fi

if [ -e /home/`logname`/Vdrrepo/lcars_pack.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://www.dropbox.com/s/806odyj5vyco3dg/lcars_pack.tar.gz
  fi

echo " Downloading others "

if [ -e /home/`logname`/Vdrrepo/traduzioni.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://www.dropbox.com/s/6hzpdx9yv5ypzxv/traduzioni.tar.gz
  fi

if [ -e /home/`logname`/Vdrrepo/oscam.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://www.dropbox.com/s/56oomdr58os7msa/oscam.tar.gz
  fi

if [ -e /home/`logname`/Vdrrepo/oscam64.tar.gz ]; then
  echo " ..... File exists ..... "
else
  echo "File not found ... Downloading it now ....."
    wget https://www.dropbox.com/s/h6sahjsfi6o0snf/oscam64.tar.gz
  fi

chmod -R 777 *;;

#############################################################

c)
clear
cd /home/`logname`/Vdrrepo
rm -rf *

echo "                    Downloading libraries on local repo "

git clone https://github.com/intel/cmrt
git clone https://github.com/intel/libva
git clone https://github.com/01org/intel-hybrid-driver
git clone https://github.com/intel/intel-vaapi-driver.git
git clone https://github.com/intel/libva-utils
wget https://ffmpeg.org/releases/ffmpeg-4.4.1.tar.bz2

echo "                    Downloading Vdr and Plugins on local repo "

#wget https://github.com/vdr-projects/vdr/archive/refs/tags/2.6.1.tar.gz

wget https://www.dropbox.com/s/o87kvrdx3zocksm/vdr-patches.2.6.1.tar.gz
wget https://www.dropbox.com/s/qds2k91od7oboed/Make.config.tar.gz
wget https://www.dropbox.com/s/bx97ikp7c1h2qj2/vdrsymbols.tar.gz
git clone http://projects.vdr-developer.org/git/vdr-plugin-epgsearch.git
wget https://www.dropbox.com/s/s9vggu8mil8ss7t/patch_epgsearch.tar.gz
git clone git://github.com/manio/vdr-plugin-dvbapi.git
wget https://www.dropbox.com/s/dv6okhltz3eu20i/vdr-plugin-radio-master.tar.gz
git clone https://github.com/rofafor/vdr-plugin-iptv.git
wget https://www.dropbox.com/s/nof5ydmxrplw2b0/patch_iptv.tar.gz
wget https://www.dropbox.com/s/vmhkf4rzhoh4wa5/iptv_conf.tar.gz
git clone https://github.com/ua0lnj/vdr-plugin-mpv.git
git clone https://bitbucket.org/ua0lnj/channelscan.git
wget https://www.dropbox.com/s/wm7c6nx4ymbcdk1/satellite_pack.tar.gz
wget http://firefly.vdr-developer.org/systeminfo/vdr-systeminfo-0.1.5.tar.bz2

echo "                    Downloading skins "

git clone https://gitlab.com/kamel5/skindesigner.git
git clone https://gitlab.com/kamel5/SkinNopacity.git
wget https://www.dropbox.com/s/806odyj5vyco3dg/lcars_pack.tar.gz

echo "                    Downloading others "

wget https://www.dropbox.com/s/6hzpdx9yv5ypzxv/traduzioni.tar.gz
wget https://www.dropbox.com/s/5uvx468b4b87auy/icone.tar.gz
wget https://www.dropbox.com/s/56oomdr58os7msa/oscam.tar.gz
wget https://www.dropbox.com/s/h6sahjsfi6o0snf/oscam64.tar.gz
#wget https://www.dropbox.com/s/eeopbzh4gbyuir1/logos.tar.gz
git clone https://github.com/fiveten59/Logos.git logos
#
chmod -R 777 *;;
z) ;;
esac ;;

#############################################################

2)

clear
apt-get -y install libass-dev zlib1g zlib1g-dev libva-dev libdrm-dev libvorbis-dev
apt-get -y install cmake-curses-gui libogg-dev git libx11-dev libperl-dev libpciaccess-dev libpciaccess0
apt-get -y install libxcb-dpms0-dev libxcb-glx0-dev libxcb-randr0-dev libxcb-screensaver0-dev
apt-get -y install libxcb-xv0-dev libxcb-image0-dev libxcb-util0-dev libxcb-icccm4-dev libxcb-keysyms1-dev
apt-get -y install libtheora-dev libxvidcore-dev libmp3lame-dev libavfilter-dev libfreetype6-dev
apt-get -y install freeglut3 freeglut3-dev libglew-dev libglm-dev mesa-common-dev libssl-dev
apt-get -y install libopencore-amrnb-dev libopencore-amrwb-dev libudev-dev libv4l-dev libwebp-dev
apt-get -y install libxcb-ewmh-dev libx265-dev libasound2-dev libfontconfig1-dev libfribidi-dev librsvg2-dev
apt-get -y install libxml2-dev xorg-dev libvdpau-dev libx264-dev gawk

echo "                    Installing Sat firmware & drivers"
sleep 2
if [ -f /usr/local/src/driver_dvb/check ]
then echo " Sat firmwares & drivers are already installed"; sleep 2
else
cd /usr/local/src
wget https://www.dropbox.com/s/waolpom1x6nnktv/driver_dvb.tar.gz
tar -zxvf driver_dvb.tar.gz
rm -rf driver_dvb.tar.gz
cd driver_dvb
cp -rf *.fw /lib/firmware/
cd dvbsky-firmware
cp -rf *.fw /lib/firmware/
cd ../Hauppuage
dd if=hcw88bda.sys of=/lib/firmware/dvb-fe-cx24116-1.26.90.0.fw bs=1 skip=105768 count=32290
ln -s /lib/firmware/dvb-fe-cx24116-1.26.90.0.fw /lib/firmware/dvb-fe-cx24116.fw
echo " Sat firmwares & drivers are now installed"; sleep 2
fi
#
cd /usr/local/src
mkdir -p ffmpeg_sources
#
clear
dialog --title "   ** Install Intel / Nvidia & Common Libraries **   " --infobox "
   --------------------------------------------------------------------------------------------------
                                     Install or Remove Libraries
-----------------------------------------------------------------------------------------------------

        *****  Install  *****
        [a]    ONLY FOR Intel Devices (Libva - Cmrt - Intel hybrid driver - Intel vaapi driver - Libva-utils)
        [b]    Common Libs (Ffmpeg) & Infra-Red Remotes Control

        *****  Remove  *****

                                *****     Remove Intel Libs      *****
        [a1]    Libva
        [b1]    Cmrt
        [c1]    Intel hybrid driver
        [d1]    Intel vaapi driver
        [e1]    Libva-utils

                                *****     Remove Common Libs      *****

        [f1]    FFMPEG
        [g1]    Lirc
        [h1]    Eventlircd

        [z]     Skip

--------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
" 0 0

echo -n "        Enter your menu choice = Install [a-b] ~~ Remove [a1-h1] ~~ Exit [z]:      "
read yourch
case $yourch in

#############################################################
a)

clear
echo "                    Installing Ubuntu-graphics-drivers"
sleep 2
if [ -f /etc/apt/sources.list.d/oibaf-ubuntu-graphics-drivers-focal.list ]
  then echo "Graphics-drivers already installed"
else
add-apt-repository ppa:oibaf/graphics-drivers
apt-get update
apt-get -y upgrade
apt-get -y dist-upgrade
fi
#
echo "                    Installing Libva"
sleep 2
if [ -d /usr/local/src/ffmpeg_sources/libva ]
then echo " Libva is already installed"
else
cd /usr/local/src/ffmpeg_sources
cp -rf /home/`logname`/Vdrrepo/libva /usr/local/src/ffmpeg_sources
cd libva
./autogen.sh
./configure
make && make install
rm -rf /etc/ld.so.conf
touch /etc/ld.so.conf
    echo 'include /etc/ld.so.conf.d/*.conf
/usr/local/lib
/usr/local/lib/dri' >> /etc/ld.so.conf
fi
#
echo "                    Installing Cmrt"
sleep 2
if [ -d /usr/local/src/ffmpeg_sources/cmrt ]
then echo " Cmrt is already installed"
else
cd /usr/local/src/ffmpeg_sources
cp -rf /home/`logname`/Vdrrepo/cmrt /usr/local/src/ffmpeg_sources
cd cmrt
./autogen.sh
./configure
time make -j4 VERBOSE=1
make -j4 install
fi
#
echo "                    Installing Intel-hybrid-driver"
sleep 2
if [ -d /usr/local/src/ffmpeg_sources/intel-hybrid-driver ]
then echo " Intel-hybrid-driver is already installed"
else
cd /usr/local/src/ffmpeg_sources
cp -rf /home/`logname`/Vdrrepo/intel-hybrid-driver /usr/local/src/ffmpeg_sources
cd intel-hybrid-driver
./autogen.sh
./configure
make -j4 VERBOSE=1
make -j4 install
fi
#
echo "                    Installing Intel-Vaapi-driver"
sleep 2
if [ -d /usr/local/src/ffmpeg_sources/intel-vaapi-driver ]
then echo " Intel-Vaapi-driver is already installed"
else
cd /usr/local/src/ffmpeg_sources
cp -rf /home/`logname`/Vdrrepo/intel-vaapi-driver /usr/local/src/ffmpeg_sources
cd intel-vaapi-driver
./autogen.sh
./configure
make -j4 VERBOSE=1
make -j4 install
fi
#
echo "                    Installing Libva-utils"
sleep 2
if [ -d /usr/local/src/ffmpeg_sources/libva-utils ]
then echo " Libva-utils is already installed"
else
cd /usr/local/src/ffmpeg_sources
rm -rf libva-utils
cp -rf /home/`logname`/Vdrrepo/libva-utils /usr/local/src/ffmpeg_sources
cd libva-utils
./autogen.sh
./configure
make -j4 VERBOSE=1
make -j4 install
fi;;

#############################################################

b)

clear
echo "                    Installing Common Libs"
sleep 3
clear

echo "                    Installing Nv-Codec"
sleep 2
	if [ -f /usr/local/src/ffmpeg_sources/nv-codec-headers/Makefile ]
  then echo "nv-codec-headers are already installed"; sleep 3
else
    cd /usr/local/src/ffmpeg_sources
    git clone https://git.videolan.org/git/ffmpeg/nv-codec-headers.git
    cd nv-codec-headers
    make && make install
	fi
#
echo "                    Installing Ffmpeg"
sleep 2
if [ -d /usr/local/src/ffmpeg_sources/ffmpeg ]
then echo "Ffmpeg is already installed"; sleep 3
else
    echo "                    Wait for a few seconds ..."

cd /usr/local/src/ffmpeg_sources
cp -rf /home/`logname`/Vdrrepo/ffmpeg-4.4.1.tar.bz2 /usr/local/src/ffmpeg_sources/
tar xjvf ffmpeg-4.4.1.tar.bz2
mv ffmpeg-4.4.1 ffmpeg
rm -rf ffmpeg-4.4.1.tar.bz2
cd ffmpeg
./configure --extra-libs="-ldl" --enable-gpl --enable-libfreetype --enable-libmp3lame --enable-openssl --enable-libxcb --disable-libopus --enable-libtheora --enable-libvorbis --enable-libx264 --enable-libx265 --enable-cuvid --enable-nonfree --enable-libxvid --enable-opengl --enable-vdpau --enable-vaapi --enable-pic --enable-shared  --disable-doc --enable-swresample --disable-avresample --enable-nvenc --enable-cuda --disable-cuda-sdk
    echo "                    Press Enter to continue ...               "
    read enterKey
make -j10
checkinstall --pkgname=ffmpeg --pkgversion="2.6.1" --backup=no --deldoc=yes --fstrans=no --default --pakdir=$PACKAGES
fi;
#

echo "                 *** InstallingInfra-Red Remotes Control  ***"
sleep 2
clear
#
    dialog --title "   ** Infra-Red Remotes Control **   " --infobox "
   ----------------------------------------------
              Infra-Red Remotes Control
   ----------------------------------------------
        [a]    Lirc
        [b]    Eventlircd

        [z]    Skip

    ---------------------------------------------- " 0 0
    echo -n "        Enter your menu choice  [a-z]:      "
    read yourch
    case $yourch in

a) clear; if [ -d /etc/lirc/hardware.conf ]
then echo " Lirc is already installed"; sleep 3
else apt remove ir-keytable lirc; echo 'deb http://ca.archive.ubuntu.com/ubuntu/ xenial universe' >>  /etc/apt/sources.list; apt update; apt -y install lirc/xenial; apt -y install lirc-x/xenial; sed -i "s|deb http://ca.archive.ubuntu.com/ubuntu/ xenial universe||" /etc/apt/sources.list; apt update; echo " Lirc is now installed"; sleep 3; fi;;
#
b) clear; if [ -d /usr/sbin/eventlircd ]
then echo " Eventlircd is already installed"; sleep 3
else cd /usr/local/src; git clone https://github.com/OpenELEC/eventlircd.git;
cp -rf eventlircd /home/`logname`/Vdrrepo;
cd eventlircd;
cp -rf eventlircd /home/`logname`/Vdrrepo;
wget https://www.dropbox.com/s/5qyshoaz1z97auu/eventlircd_patch.tar.gz;
tar -zxvf eventlircd_patch.tar.gz;
mv -f eventlircd_patch.tar.gz /home/`logname`/Vdrrepo;
patch -p1 < eventlircd_makefile.patch; patch -p1 < eventlircd_configure.patch; patch -p1 < eventlircd_version.patch; autoreconf -fi; ./configure --sysconfdir=/etc --with-evmap=/etc/eventlircd.d --with-udev-dir=/lib/udev --with-lircd-socket=/var/run/lirc/lircd; make; make install; 
echo 'uinput
i2c-dev
ir-kbd-i2c' >> /etc/modules
wget https://www.dropbox.com/s/pou5xp8yuxkgvzw/eventlircd.conf.tar.gz; tar -zxvf eventlircd.conf.tar.gz; mv -f evmap.tar.gz /etc/eventlircd.d; mv -f rules.tar.gz /lib/udev/rules.d; mv -f rc_keymaps /lib/udev/; cd /lib/udev/rc_keymaps; chmod 0644 *; cd /etc/eventlircd.d; tar -zxvf evmap.tar.gz; chmod 0644 *; rm -rf evmap.tar.gz; cd /lib/udev/rules.d; rm -rf 98-eventlircd.rules.disabled; rm -rf 98-lircd.rules.disabled; tar -zxvf rules.tar.gz; chmod 0644 *; rm -rf rules.tar.gz; cd $SRC/eventlircd; mv -f eventlircd.conf.tar.gz /home/`logname`/Vdrrepo; echo "Eventlircd is now installed"; 
sleep 3
fi;;
#
z);;
esac;;

##############################################################
#############################################################

a1)
clear
echo "                    Removing Libva "
sleep 2
cd $PACKAGES
dpkg -r libva.deb
rm -rf /usr/local/src/ffmpeg_sources/libva
rm -rf $PACKAGES/libva*;;
#
#
b1)
clear
echo "                    Removing Cmrt "
sleep 2
cd $PACKAGES
dpkg -r cmrt.deb
rm -rf /usr/local/src/ffmpeg_sources/cmrt
rm -rf $PACKAGES/Cmrt*;;
#
#
c1)
clear
echo "                    Removing Intel-hybrid-driver "
sleep 2
cd $PACKAGES
dpkg -r intel-hybrid.deb
rm -rf /usr/local/src/ffmpeg_sources/intel-hybrid-driver
rm -rf $PACKAGES/intel-hybrid*;;
#
#
d1)
clear
echo "                    Removing Intel-vaapi-driver "
sleep 2
cd $PACKAGES
dpkg -r intel-vaapi.deb
rm -rf /usr/local/src/ffmpeg_sources/intel-vaapi-driver
rm -rf $PACKAGES/intel-vaapi*;;
#
#
e1)
clear
echo "                    Removing Libva-utils "
sleep 2
cd $PACKAGES
dpkg -r libva-utils.deb
rm -rf /usr/local/src/ffmpeg_sources/libva-utils
rm -rf $PACKAGES/libva-utils*;;
#
#
f1)
clear
echo "                    Removing FFmpeg "
sleep 2
cd $PACKAGES
dpkg -r ffmpeg.deb
rm -rf /usr/local/src/ffmpeg_sources/nv-codec-headers
rm -rf /usr/local/src/ffmpeg_sources/ffmpeg
rm -rf $PACKAGES/ffmpeg*.deb;;
#
#
g1)
clear
echo "                    Removing Lircd "
apt remove lirc lirc-x
apt purge lirc lirc-x;;
#
#
h1)
clear
echo "                    Removing Eventlircd "
rm -rf /etc/modules
rm -rf /etc/eventlircd.d
rm -rf /usr/sbin/eventlircd
rm -rf $SRC/eventlircd;;
#
#
z) ;;
esac;;

#############################################################

3)

clear
    dialog --title "   ** Install VDR-2.6.x & Basic plugins   **   " --infobox "
   ---------------------------------------------------------------------------------------------

        *****  Install  *****  .....................  *****  Remove  *****

        [a]    Install VDR-2.6.x & Basic plugins ........  [a1]    Remove VDR-2.6.x & Basic plugins
        [b]    First & Refresh VDR Setup ..........................

        [z]    Skip

   --------------------------------------------------------------------------------------------- " 0 0
    echo -n "        Enter your menu choice = Install [a-b] ~~ Remove [a1] ~~ Exit [z]:      "
    read yourch
    case $yourch in

a)
clear
#
echo "*** Install Vdr libraries ***"
sleep 3
cd $SRC
apt-get -y install libfontconfig1-dev libfreetype6-dev libfribidi-dev gettext binutils
apt-get -y install libglibmm-2.4-dev libcap-dev libjpeg-dev libtinyxml-dev
apt-get -y install libncurses5-dev libncursesw5-dev linux-libc-dev python3
#
#
clear
echo " Installing VDR      "
sleep 1
#
cp -rf /home/`logname`/Vdrrepo/$VDR.tar.bz2 $SRC/
tar xivf $VDR.tar.bz2
ln -s $VDR vdr
rm -rf $VDR.tar.bz2

echo " Patching VDR      "
sleep 1
cd vdr
cp -rf /home/`logname`/Vdrrepo/vdr-patches.2.6.1.tar.gz $SRC/vdr/
tar -zxvf vdr-patches.2.6.1.tar.gz
rm -rf vdr-patches.2.6.1.tar.gz
sleep 1
#
echo " *** Patching avcdescriptor ***"
    patch -p1 < vdr_avcdescriptor.patch
echo " *** config ***"
    patch -p1 < vdr_config.patch
echo " *** Patching dvb_power_saving_feature ***"
    patch -p1 < vdr_dvb_power_saving_feature.patch
echo " *** Patching ClearObsoleteChannels ***"
    patch -p1 < vdr_HelmutB_ClearObsoleteChannels.patch
#echo " *** mainmenuhooks ***"
#    patch -p1 < vdr_mainmenuhook.patch
echo " *** Patching vdr_maxdevice ***"
    patch -p1 < vdr_maxdevice.patch
#echo " *** Patching vdr_menuorg ***"
#    patch -p1 < vdr_menuorg.patch
echo " *** Patching menuselection ***"
    patch -p1 < vdr_menuselection.patch
echo " *** Patching skinlcarsng ***"
#    patch -p1 < vdr_skinlcarsng_numrecordings.patch
#echo " *** Patching svdrphosts ***"
    patch -p1 < vdr_svdrphosts.patch
echo " *** Patching ttxtsub ***"
    patch -p1 < vdr_ttxtsub.patch
echo " *** Patching wareagleicon ***"
    patch -p1 < vdr_wareagleicon.patch
echo " *** Patching zapcockpit ***"
    patch -p1 < vdr_zapcockpit.patch
#
cp -rf $VDRSRC/pictures/pic2mpg /usr/local/bin/
#
make && make plugins
exit_status_check
clear
echo "                *** Final compilation ***"
echo ""
cd /usr/local/src/vdr
checkinstall --fstrans=no --install=yes --pkgname=vdr --pkgversion "2.6.1" --pakdir=$PACKAGES --default
rm -rf /media/video
mkdir /media/video
mkdir -p /etc/vdr/plugins
cp *.conf /etc/vdr
mkdir -p /usr/local/lib/vdr/plugins
#
clear
echo "*** keymacros.conf setup ***"
rm -rf /etc/vdr/keymacros.conf
cd $SRCVDR
cp -rf vdr /usr/local/bin/
touch /etc/vdr/keymacros.conf
echo "# Remote control key macros for VDR
#
# Format:
#
# macrokey  key1 key2 key3...
# macrokey  @plugin key1 key2 key3...
#
# See man vdr(5)

Red       Recordings
Green     @channelscan
Yellow    Info
Blue      @tvguide
Ok        Channels" >> /etc/vdr/keymacros.conf
#
/usr/local/bin/vdr --help
exit_status_check
#
echo " Installing Italian translation for some plugins "
cd $SRC
mkdir -p traduzioni
cd traduzioni
cp /home/`logname`/Vdrrepo/traduzioni.tar.gz /$SRC/traduzioni/
tar -zxvf traduzioni.tar.gz
rm -rf traduzioni.tar.gz
#
clear
echo "Install Basic plugins  ( Softhddevice / Softhdcuvid / Xineliboutput - Dvbapi - Epgsearch - SkinNopacity - Skindesigner - Iptv - Radio - Channelscan - System Info)"
echo "                 Press Enter to continue ...         "
read enterKey
cd $SRC
mkdir -p /etc/vdr/plugins
mkdir -p /etc/vdr/themes
mkdir -p /$SHARE/skindesigner/scripts
#
echo "               *** Setup Softhddevice / Softhdcuvid / Xineliboutput  ***"
sleep 2
clear
		dialog --title "   ** Setup Softhddevice / Softhdcuvid / Xineliboutput **   " --infobox "
	-------------------------------------------------------------------------
	-------------------------------------------------------------------------

                                Nvidia Video Devices
	        [a]    Softhddevice (default)
	        [b]    Softhdcuvid
	        [c]    Xineliboutput

                                Intel Video Devices
	        [d]    Softhddevice (default)
	        [e]    Softhdcuvid

	------------------------------------------------------------------------- " 0 0

echo -n "        Enter your menu choice  [a-e]:      "
read yourch
case $yourch in
#
a)
clear
echo "               *** Softhddevice**"
sleep 3
apt-get -y install libx11-xcb-dev libc6-dev libogg0
apt-get -y install libxcb-ewmh-dev libasound2-dev libxext6 libxext-dev
apt-get -y install libvdpau1 libavcodec-dev libavformat-dev libswresample-dev libswscale-dev
apt-get -y install libglu1-mesa-dev libgl1-mesa-dev
cd $VDRSRC
git clone https://github.com/ua0lnj/vdr-plugin-softhddevice.git
cp -rf /$VDRSRC/vdr-plugin-softhddevice /home/`logname`/Vdrrepo/
mv vdr-plugin-softhddevice softhddevice
cd softhddevice
make && make install;;
#
b)
clear
echo "               *** Softhdcuvid **"
sleep 3
apt-get -y install libx11-xcb-dev libc6-dev libogg0
apt-get -y install libxcb-ewmh-dev libasound2-dev libxext6 libxext-dev
apt-get -y install libvdpau1 libavcodec-dev libavformat-dev libswresample-dev libswscale-dev
apt-get -y install libglu1-mesa-dev libgl1-mesa-dev libplacebo-dev libavfilter-dev
cd $VDRSRC
wget https://github.com/jojo61/vdr-plugin-softhdcuvid/archive/master.tar.gz
cp -rf /$VDRSRC/master.tar.gz /home/`logname`/Vdrrepo/
tar -zxvf master.tar.gz
mv vdr-plugin-softhdcuvid-master softhdcuvid
rm -rf master.tar.gz
cd softhdcuvid
rm -rf Makefile
wget https://www.dropbox.com/s/50olrxtjn8pcon1/patch_softhdcuvid.tar.gz
cp -rf /$VDRSRC/softhdcuvid/patch_softhdcuvid.tar.gz /home/`logname`/Vdrrepo/
tar -zxvf patch_softhdcuvid.tar.gz
rm -rf patch_softhdcuvid.tar.gz
patch -p1 < 03_LanguageIT.patch
make && make install;;
#
c)
clear
echo "               *** Xineliboutput***"
sleep 3
echo "                    Installing Xine-lib"
sleep 1
cd $SRC
apt-get -y install libxine2-dev libxrender-dev libextractor-dev libxrandr-dev libxine2-ffmpeg mjpegtools
if [ -f /usr/local/lib/win32/cook.so ]; then
    echo "Codecs $Remind3"
    	else
	    wget http://www.mplayerhq.hu/MPlayer/releases/codecs/all-20110131.tar.bz2
	    cp -rf /$VDRSRC/all-20110131.tar.bz2 /home/`logname`/Vdrrepo/
	    tar xivf all-20110131.tar.bz2
	    rm -rf all-20110131.tar.bz2
	    mv all-20110131 /usr/local/lib/win32
	    ln -s /usr/local/lib/win32 /usr/local/lib/codecs
     fi
#
if [ -f $PACKAGES/libxine2*.deb ]; then
    echo "Xine-lib $Remind3"
    	else cd $SRC
    	wget https://sourceforge.net/projects/xine/files/xine-lib/1.2.11/xine-lib-1.2.11.tar.xz
    	tar -xJf xine-lib-1.2.11.tar.xz
    	mv xine-lib-1.2.11 xine-lib
    	rm -rf xine-lib-1.2.11.tar.xz
    	cd xine-lib
    	export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
    	./configure --disable-dxr3 --enable-w32dll --with-pic --with-w32-path=/usr/local/lib/win32
    	make -j4
    	checkinstall --fstrans=no --install=yes --pkgname=libxine2 --pkgversion "1.2.11-git" --pakdir=$PACKAGES --default
	fi
#
echo "                    Installing Xineliboutput"
sleep 3
cd $VDRSRC
wget https://sourceforge.net/projects/xineliboutput/files/xineliboutput/vdr-xineliboutput-2.2.0/vdr-xineliboutput-2.2.0.tgz
tar zxvf vdr-xineliboutput-2.2.0.tgz
rm -rf vdr-xineliboutput-2.2.0.tgz
cp -rf /$VDRSRC/xineliboutput-2.2.0 /home/`logname`/Vdrrepo/
mv -f xineliboutput-2.2.0 xineliboutput
cd xineliboutput
wget https://www.dropbox.com/s/11clb1n2b6itave/patch_xineliboutput.tar.gz
tar -zxvf patch_xineliboutput.tar.gz
rm -rf patch_xineliboutput.tar.gz
patch -p1 < configure.patch
patch -p1 < 12_xineliboutput_dfatmo-switch.patch
patch -p1 < 13_xineliboutput_null.patch
./configure --enable-vdr --disable-opengl --enable-libxine --disable-libcec
make && make install
cd ../../..
make plugins
mkdir -p /etc/vdr/plugins/xineliboutput
cp -rf /usr/local/src/vdr/PLUGINS/src/xineliboutput/*.mpg /etc/vdr/plugins/xineliboutput
cp -rf /usr/local/src/vdr/PLUGINS/src/xineliboutput/examples/remote.conf.example /etc/vdr/plugins/xineliboutput/remote.conf
echo "*** allowed_hosts.conf setup ***"
touch /etc/vdr/plugins/xineliboutput/allowed_hosts.conf
echo "$ALLOWED" >> /etc/vdr/plugins/xineliboutput/allowed_hosts.conf;;
# patch -p1 < 10_xineliboutput_mld.patch;wget https://www.dropbox.com/s/11clb1n2b6itave/patch_xineliboutput.tar.gz; tar -zxvf patch_xineliboutput.tar.gz; rm -rf patch_xineliboutput.tar.gz;  patch -p1 < configure.patch;  sleep 1; patch -p1 < 12_xineliboutput_dfatmo-switch.patch; sleep 1; patch -p1 < 13_xineliboutput_null.patch;
#
d)
clear
echo "               *** Softhddevice (default)**"
sleep 3
apt-get -y install libx11-xcb-dev libc6-dev libogg0
apt-get -y install libxcb-ewmh-dev libasound2-dev libxext6 libxext-dev
apt-get -y install libvdpau1 libavcodec-dev libavformat-dev libswresample-dev libswscale-dev
apt-get -y install libglu1-mesa-dev libgl1-mesa-dev
cd $VDRSRC
git clone https://github.com/ua0lnj/vdr-plugin-softhddevice.git
cp -rf /$VDRSRC/vdr-plugin-softhddevice /home/`logname`/Vdrrepo/
mv vdr-plugin-softhddevice softhddevice
cd softhddevice
make && make install;;
#
e)
clear
echo "               *** Softhdcuvid **"
sleep 3
apt-get -y install libx11-xcb-dev libc6-dev libogg0
apt-get -y install libxcb-ewmh-dev libasound2-dev libxext6 libxext-dev
apt-get -y install libvdpau1 libavcodec-dev libavformat-dev libswresample-dev libswscale-dev
apt-get -y install libglu1-mesa-dev libgl1-mesa-dev libplacebo-dev libavfilter-dev
cd $VDRSRC
wget https://github.com/jojo61/vdr-plugin-softhdcuvid/archive/master.tar.gz
cp -rf /$VDRSRC/master.tar.gz /home/`logname`/Vdrrepo/
tar -zxvf master.tar.gz
mv vdr-plugin-softhdcuvid-master softhdcuvid
cd softhdcuvid
wget https://www.dropbox.com/s/h6w4axdur1jn6qx/patch_softhddevice_ua0lnj.tar.gz
cp -rf /$VDRSRC/softhddevice/patch_softhddevice_ua0lnj.tar.gz /home/`logname`/Vdrrepo/
tar -zxvf patch_softhddevice_ua0lnj.tar.gz
rm -rf patch_softhddevice_ua0lnj.tar.gz
patch -p1 < 03_LanguageIT.patch
make && make install;;
esac
#
#
echo "               *** Dvbapi ***"
sleep 3
cd $VDRSRC
cp -rf /home/`logname`/Vdrrepo/vdr-plugin-dvbapi /$VDRSRC/
mv vdr-plugin-dvbapi dvbapi
cd ../..
make plugins
#
#
echo "               *** Epgsearch ***"
sleep 3
cd $VDRSRC
apt-get -y install libc6 libgcc1 libstdc++6
cp -rf /home/`logname`/Vdrrepo/vdr-plugin-epgsearch /$VDRSRC/
mv vdr-plugin-epgsearch epgsearch
cd epgsearch
cp -rf /home/`logname`/Vdrrepo/patch_epgsearch.tar.gz /$VDRSRC/epgsearch/
tar -zxvf patch_epgsearch.tar.gz
rm -rf patch_epgsearch.tar.gz
patch -p1 < 10_langinfo-include.diff
patch -p1 < 11_epgsearch_menue.patch
patch -p1 < 12_epgsearch_README.patch
cd ../../..
make plugins
#
#
echo ""; echo "               *** SkinNopacity ***"
sleep 3
apt-get -y install graphicsmagick-libmagick-dev-compat
apt-get -y install lm-sensors libexpat1 libexpat1-dev
apt-get -y install libglib2.0-0 libpcre3 libpcre3-dev
cd $VDRSRC
cp -rf /home/`logname`/Vdrrepo/SkinNopacity /$VDRSRC
cd SkinNopacity
make install
#
#
echo "               *** Skindesigner ***"
sleep 3
apt-get -y install libcurl4 libcurl4-gnutls-dev librsvg2-dev libxml2-dev libcairo2-dev
cd $VDRSRC
cp -rf /home/`logname`/Vdrrepo/skindesigner /$VDRSRC/
cd skindesigner
make && make install
#
#
echo "               *** Iptv ***"
sleep 3
apt-get -y install vlc mplayer
cd $VDRSRC
cp -rf /home/`logname`/Vdrrepo/vdr-plugin-iptv /$VDRSRC
mv vdr-plugin-iptv iptv
cd iptv
cp -rf /home/`logname`/Vdrrepo/patch_iptv.tar.gz /$VDRSRC/iptv
tar -zxvf patch_iptv.tar.gz
rm -rf patch_iptv.tar.gz
patch -p1 < 10_iptv_protocolext.patch
make
cd ../../..
make plugins
#
#
echo "               *** Radio ***"
sleep 3
cd $VDRSRC
cp -rf /home/`logname`/Vdrrepo/vdr-plugin-radio-master.tar.gz /$VDRSRC
tar -zxvf vdr-plugin-radio-master.tar.gz
mv vdr-plugin-radio-master radio
rm -rf vdr-plugin-radio-master.tar.gz
cd radio
make
cd ../../..
make plugins
cd $PLUGINS
mkdir -p radio
cp -rf $VDRSRC/radio/config/mpegstill/* $PLUGINS/radio/
cp -rf $VDRSRC/radio/config/scripts/* $PLUGINS/radio/
#
#
echo "               *** Channelscan ***"
sleep 3
apt-get -y install libboost-iostreams-dev python3-dev libbz2-dev
cd $VDRSRC
cp -rf /home/`logname`/Vdrrepo/channelscan /$VDRSRC
cp -rf $VDRSRC/channelscan/script/* /usr/local/bin
cd ../..
make plugins
cd $PLUGINS
mkdir -p transponders
cp -rf /home/`logname`/Vdrrepo/satellite_pack.tar.gz  $PLUGINS/transponders
cd transponders
tar -zxvf satellite_pack.tar.gz
rm -rf satellite_pack.tar.gz
#
#
echo "              *** Mpv ***"; echo ""
sleep 3
apt-get -y install mpv libmpv-dev libmpv1 libxrandr-dev
cd $VDRSRC
cp -rf /home/`logname`/Vdrrepo/vdr-plugin-mpv /$VDRSRC
mv vdr-plugin-mpv mpv
cd mpv
make && make install
#
#
echo "               *** System Info ***"
sleep 3
cd $VDRSRC
cp -rf /home/`logname`/Vdrrepo/vdr-systeminfo-0.1.5.tar.bz2 /$VDRSRC
tar xivf vdr-systeminfo-0.1.5.tar.bz2
mv systeminfo-0.1.5 systeminfo
rm -rf vdr-systeminfo-0.1.5.tar.bz2
mv -f $VDRSRC/systeminfo/scripts/systeminfo.sh /usr/local/bin/
cd ../..
make plugins
#
cd $SRC/vdr
make plugins install
#
cd /home/`logname`/Vdrrepo
chmod -R 777 *
#
echo "                    Press Enter to continue ...               "
read enterKey;;

#############################################################

a1)                                       #########################################
                                          #              Remove VDR-2.6.x         #
                                          #########################################


clear
echo "                    Removing VDR 2.6.x"
sleep 3
dpkg -r vdr
dpkg --purge vdr
rm -rf /etc/vdr
rm -rf /usr/share/vdr
rm -rf /usr/lib/vdr
rm -rf /var/cache/vdr
cd $SRC
rm -rf vdr vdr-*
cd packages
rm -rf vdr*.deb
rm -rf /usr/local/bin/vdrpoweroff
rm -rf /usr/local/bin/vdrrun
rm -rf /usr/local/lib/vdr
rm -rf /usr/local/bin/vdr-*
rm -rf /usr/local/bin/vdr
rm -rf /usr/local/bin/start-vdr-xine.sh
rm -rf /usr/local/bin/start-xinelib-vdr.sh
rm -rf /usr/local/share/vdr
rm -rf /usr/local/bin/start-vdr.sh
rm -rf /usr/local/bin/KillVdr.sh
rm -rf /home/`logname`/Scrivania/Xinelib.desktop
rm -rf /home/`logname`/Scrivania/Vdr-Xine.desktop
rm -rf /home/`logname`/Scrivania/Vdr.desktop
rm -rf /home/`logname`/Scrivania/KillVdr.desktop
rm -rf /usr/share/applications/Xinelib.desktop
rm -rf /usr/share/applications/Vdr-Xine.desktop
rm -rf /usr/share/applications/Vdr.desktop
rm -rf /usr/share/applications/KillVdr.desktop
rm -rf /usr/local/bin/start_eventlircd.sh
rm -rf /etc/init.d/eventlircd
#
echo "                    Press Enter to continue ...               "
read enterKey;;

#############################################################

b)
clear
#
echo "               Configuring VDR"
sleep 2
clear
echo "                    Installing true type"
sleep 1
if [ -d /usr/share/fonts/truetype/vdrsymbols ];
then echo " Fonts $Remind4"
sleep 2
else cp -rf /home/`logname`/Vdrrepo/vdrsymbols.tar.gz /usr/share/fonts/truetype/
cd /usr/share/fonts/truetype/
tar -zxvf vdrsymbols.tar.gz
fc-cache -fv
fi
#
echo "                    Installing Icons"
sleep 1
if [ -f $SRC/icone/vdr.jpg ]
then echo " Icons $Remind4"
sleep 3
else cd $SRC
cp -rf /home/`logname`/Vdrrepo/icone.tar.gz /usr/local/src/
tar -zxvf icone.tar.gz
rm -rf icone.tar.gz
fi
#
echo "                    Create Vdr start command line"
sleep 1
rm -rf /usr/local/bin/vdrrun
touch /usr/local/bin/vdrrun
echo '#!/bin/bash

/usr/local/bin/vdr -c /etc/vdr -E /var/vdr -l 3 -u root '$PLUGIN' -s /usr/local/bin/vdrpoweroff ' >> /usr/local/bin/vdrrun
chmod a+x /usr/local/bin/vdrrun
#
#
    dialog --title "   ** Create start Vdr command line **   " --infobox "
   ----------------------------------------------
          Create start Vdr command line
   ----------------------------------------------

	NVIDIA VIDEO DEVICES
        [a]    Softhddevice (default) & Mpv
        [b]    Softhdcuvid  & Mpv
        [c]    Xineliboutput  & Mpv

	INTEL VIDEO DEVICES
        [d]    Softhddevice (default)  & Mpv
        [e]    Softhdvaapi & Mpv

   ---------------------------------------------- " 0 0
echo -n "        Enter your menu choice  [a-e]:      "
read yourch
case $yourch in

a) clear; sed -i "s|-P'dvbapi'|& -P'softhddevice -f -v cuvid' -P'mpv -a alsa -b /'|" /usr/local/bin/vdrrun && cd /etc/vdr/ && wget https://www.dropbox.com/s/873qnh3yxmnzo0o/setup16_softhddevice.tar.gz && tar -zxvf setup16_softhddevice.tar.gz && mv -f /etc/vdr/setup16_softhddevice.tar.gz /home/`logname`/Vdrrepo/;;
b) clear; sed -i "s|-P'dvbapi'|& -P'softhdcuvid -f' -P'mpv -a alsa -b /'|" /usr/local/bin/vdrrun && cd /etc/vdr/ && wget https://www.dropbox.com/s/873qnh3yxmnzo0o/setup16_softhddevice.tar.gz && tar -zxvf setup16_softhddevice.tar.gz && mv -f /etc/vdr/setup16_softhddevice.tar.gz /home/`logname`/Vdrrepo/;;
c) clear; sed -i "s|-P'dvbapi'|& -P'xineliboutput --local=sxfe --fullscreen --video=vdpau --hud --audio=alsa --remote=none --post=tvtime:method=Linear,cheap_mode=1,pulldown=0,use_progressive_frame_flag=1,chroma_filter=0,enabled=1'|" /usr/local/bin/vdrrun && sed -i "s|-P'iptv'|& -P'mpv -a alsa -b /'|" /usr/local/bin/vdrrun && cd /etc/vdr/ && wget https://www.dropbox.com/s/kalujk6k7oksr6l/setup16_xineliboutput_nvidia.tar.gz && tar -zxvf setup16_xineliboutput_nvidia.tar.gz && mv -f /etc/vdr/setup16_xineliboutput_nvidia.tar.gz /home/`logname`/Vdrrepo/;;
d) clear; sed -i "s|-P'dvbapi'|& -P'softhddevice -f -v va-api' -P'mpv -a alsa -v vaapi -b /'|" /usr/local/bin/vdrrun && cd /etc/vdr/ && wget https://www.dropbox.com/s/873qnh3yxmnzo0o/setup16_softhddevice.tar.gz && tar -zxvf setup16_softhddevice.tar.gz && mv -f /etc/vdr/setup16_softhddevice.tar.gz /home/`logname`/Vdrrepo/;;
e) clear; sed -i "s|-P'dvbapi'|& -P'softhdvaapi -d :0.0 -f' -P'mpv -a alsa -v vaapi -b /`logname`'|" /usr/local/bin/vdrrun && cd /etc/vdr/ && wget https://www.dropbox.com/s/873qnh3yxmnzo0o/setup16_softhddevice.tar.gz  && tar -zxvf setup16_softhddevice.tar.gz && mv -f /etc/vdr/setup16_softhddevice.tar.gz /home/`logname`/Vdrrepo/;;
esac
#
echo "                    *** Create init.d Vdr ***"
sleep 1
rm -rf /etc/init.d/vdr
touch /etc/init.d/vdr
echo '#!/bin/sh
#
# To be copied to: /etc/init.d
# And type:
### BEGIN INIT INFO
# Provides:          VDR
# Required-Start:
# Required-Stop:
# Default-Start:     0 1 2 3 4 5 6
# Default-Stop:
# Description:       Start, Stop or Restart VDR
### END INIT INFO

# Shell functions sourced from /etc/rc.status:
set -e

# Reset status of this service
# rc_reset
#
echo "Vdr init.d script using: $1" >> /var/log/vdr.log &
case "$1" in
    start)
        echo -n "Start VDR "
       /usr/local/bin/vdrrun >> /var/log/vdr.log &
        # Remember status and be verbose
        ;;
    stop)
        echo -n "Stop VDR "

       killall -9 vdr
       killall -9 mpv
       killall -9 vlc
       killall -9 vdr-sxfe
       killall -9 vdrrun
        # Remember status and be verbose
        ;;
    restart)
        echo -n "Restart VDR "
        $0 stop
        $0 start

        # Remember status and be quiet
        ;;
    *)
        echo "Usage: $0 {start|stop|restart}"
        exit 1
        ;;
esac
exit 0
' >> /etc/init.d/vdr
chmod 755 /etc/init.d/vdr
#
rm -rf /usr/local/bin/start-vdr.sh
touch /usr/local/bin/start-vdr.sh
echo "#!/bin/sh

sudo /etc/init.d/vdr start > /dev/null 2>&1" >> /usr/local/bin/start-vdr.sh
chmod 755 /usr/local/bin/start-vdr.sh
#
echo "                    *** Create Vdr vdrpoweroff ***"
sleep 1
rm -rf /usr/local/bin/vdrpoweroff
touch /usr/local/bin/vdrpoweroff
echo '#!/bin/sh
#file name: Kill Vdr "vdrpoweroff"
killall -9 mpv & killall -9 vdr & killall -9 vlc & killall -9 vdr-sxfe & killall -9 vdrrun
# & killall -9 oscam & shutdown -h now '  >> /usr/local/bin/vdrpoweroff
chmod 755 /usr/local/bin/vdrpoweroff
#
echo "                    *** Setup Vdr icons  ***"
sleep 3
rm -rf /home/`logname`/Scrivania/Vdr.desktop
rm -rf /usr/share/applications/Vdr.desktop
touch /usr/share/applications/Vdr.desktop
chmod 777 /usr/share/applications/Vdr.desktop
echo "[Desktop Entry]
Version=1.0
Encoding=UTF-8
Type=Application
Name=Vdr
Description=Start of Vdr
Icon=/usr/local/src/icone/vdr.png
Exec=/usr/local/bin/start-vdr.sh
" >> /usr/share/applications/Vdr.desktop
chmod 777 /usr/share/applications/Vdr.desktop
#
echo "                    *** Setup Kill Vdr icon  ***"
sleep 1
rm -rf /home/`logname`/Scrivania/KillVdr.desktop
rm -rf /usr/share/applications/KillVdr.desktop
touch /usr/share/applications/KillVdr.desktop
chmod 777 /usr/share/applications/KillVdr.desktop
echo "[Desktop Entry]
Version=1.0
Encoding=UTF-8
Type=Application
Name=KillVdr
Description=Kill Vdr
Icon=/usr/local/src/icone/killvdr.png
Exec=/usr/local/bin/KillVdr.sh
" >> /usr/share/applications/KillVdr.desktop
chmod 777 /usr/share/applications/KillVdr.desktop
#
rm -rf /usr/local/bin/KillVdr.sh
touch /usr/local/bin/KillVdr.sh
echo '#!/bin/sh

sudo /etc/init.d/vdr stop > /dev/null 2>&1
' >> /usr/local/bin/KillVdr.sh
chmod 777 /usr/local/bin/KillVdr.sh
#
echo "                    *** Install default Skin for Vdr  ***"
sleep 1
if [ -f /etc/vdr/themes/checklcars ]
then echo " Default Skin is already installed"
else cp -rf /home/`logname`/Vdrrepo/lcars_pack.tar.gz /etc/vdr/themes
cd /etc/vdr/themes
tar -zxvf lcars_pack.tar.gz
cd /etc/vdr/themes
rm -rf lcars_pack.tar.gz
fi
#
echo "                    *** Install Channels logos  ***"
sleep 1
if [ -f /etc/vdr/logos/2be.png ]
then echo " Logos are already installed"
else
cp -rf /home/`logname`/Vdrrepo/logos /etc/vdr/
fi
sleep 1
#
echo "                    *** Diseqc setup  ***"
sleep 1
rm -rf /etc/vdr/diseqc.conf
rm -rf /etc/vdr/channels.conf
clear
    dialog --title "   ** diseqc.conf setup **   " --infobox "
   ----------------------------------------------
                Diseqc setup
   ----------------------------------------------

        [a]    Trial 9, 13, 19.2°E
        [b]    Dual 13, 19.2°E
        [c]    Astra 4 - 4.8°E
        [d]    Eutelsat 9°E
        [e]    Hot Bird 13°E
        [f]    Astra 19.2°E
        [g]    Astra 23°E
        [h]    Astra 28.2°E
        [i]    Turksat 42°E
        [l]    Thor 0.8°W
        [m]    Eutelsat 5°W
        [n]    Hispasat - 30°W

        [z]    Skip

   ---------------------------------------------- " 0 0
echo -n "        Enter your menu choice  [a-z]:      "
read yourch
case $yourch in

a) clear; echo "$TRIAL" >> /etc/vdr/diseqc.conf && sed -i 's/DiSEqC = 0/DiSEqC = 1/' /etc/vdr/setup.conf && cd /etc/vdr/ && wget https://www.dropbox.com/s/oebo5gddykvxng4/channels.conf.trial.tar.gz && tar -zxvf channels.conf.trial.tar.gz && mv -f /etc/vdr/channels.conf.trial.tar.gz /home/`logname`/Vdrrepo/; echo "Channell list installed"; sleep 2;;
b) clear; echo "$DUAL" >> /etc/vdr/diseqc.conf && sed -i 's/DiSEqC = 0/DiSEqC = 1/' /etc/vdr/setup.conf && cd /etc/vdr/ && wget https://www.dropbox.com/s/0h0dczjbx288aat/channels.conf.dual.tar.gz && tar -zxvf channels.conf.dual.tar.gz && mv -f /etc/vdr/channels.conf.dual.tar.gz /home/`logname`/Vdrrepo/; echo "Channell list installed"; sleep 2;;
# c);;
d) echo "$MONO9" >> /etc/vdr/diseqc.conf && sed -i 's/DiSEqC = 1/DiSEqC = 0/' /etc/vdr/setup.conf && cd /etc/vdr/ && wget https://www.dropbox.com/s/5ua5501tc74biys/channels-w_scan2-Eutelsat_9.conf.tar.gz && tar -zxvf channels-w_scan2-Eutelsat9.conf.tar.gz && mv -f /etc/vdr/channels-w_scan2-Eutelsat9.conf.tar.gz /home/`logname`/Vdrrepo/; echo "Channell list installed"; sleep 2;;
e) clear; echo "$MONO13" >> /etc/vdr/diseqc.conf && sed -i 's/DiSEqC = 1/DiSEqC = 0/' /etc/vdr/setup.conf && cd /etc/vdr/ && wget https://www.dropbox.com/s/oebo5gddykvxng4/channels.conf.trial.tar.gz && tar -zxvf channels.conf.trial.tar.gz && mv -f /etc/vdr/channels.conf.trial.tar.gz /home/`logname`/Vdrrepo/; echo "Channell list installed"; sleep 2;;
f) clear; echo "$MONO19" >> /etc/vdr/diseqc.conf && sed -i 's/DiSEqC = 1/DiSEqC = 0/' /etc/vdr/setup.conf && cd /etc/vdr/ && wget https://www.dropbox.com/s/igp1yulhe9lj4o6/channels-w_scan2-Astra_19.conf.tar.gz && tar -zxvf channels-w_scan2-Astra_19.conf.tar.gz && mv -f /etc/vdr/channels-w_scan2-Astra_19.conf.tar.gz /home/`logname`/Vdrrepo/; echo "Channell list installed"; sleep 2;;
g) echo "$MONO23" >> /etc/vdr/diseqc.conf && sed -i 's/DiSEqC = 1/DiSEqC = 0/' /etc/vdr/setup.conf && cd /etc/vdr/ && wget https://www.dropbox.com/s/4kd5zwqkmac34nt/channels-w_scan2-Astra23.conf.tar.gz && tar -zxvf channels-w_scan2-Astra23.conf.tar.gz && mv -f /etc/vdr/channels-w_scan2-Astra23.conf.tar.gz /home/`logname`/Vdrrepo/; echo "Channell list installed"; sleep 2;;
h) echo "$MONO28" >> /etc/vdr/diseqc.conf && sed -i 's/DiSEqC = 1/DiSEqC = 0/' /etc/vdr/setup.conf && cd /etc/vdr/ && wget https://channelpedia.yavdr.com/gen/DVB-S/S28.2E/S28.2E_complete_sorted_by_groups.channels.conf/S28.2E_complete_sorted_by_groups.channels.conf && mv -f S28.2E_complete_sorted_by_groups.channels.conf Astra28_channels.conf && cp -rf Astra28_channels.conf /home/`logname`/Vdrrepo/; echo "Channell list installed"; sleep 2;;
i) echo "$MONO42" >> /etc/vdr/diseqc.conf && sed -i 's/DiSEqC = 1/DiSEqC = 0/' /etc/vdr/setup.conf && cd /etc/vdr/ && wget https://www.dropbox.com/s/ax4l7pa7ckp9ndk/channels-w_scan2-Turksat.conf.tar.gz && tar -zxvf channels-w_scan2-Turksat.conf.tar.gz && mv -f /etc/vdr/channels-w_scan2-Turksat.conf.tar.gz /home/`logname`/Vdrrepo/; echo "Channell list installed"; sleep 2;;
l) echo "$MONO08W" >> /etc/vdr/diseqc.conf && sed -i 's/DiSEqC = 1/DiSEqC = 0/' /etc/vdr/setup.conf && cd /etc/vdr/ && wget https://www.dropbox.com/s/sqq40r6i461s1mx/channels-w_scan2-Thor.conf.tar.gz  && tar -zxvf channels-w_scan2-Thor.conf.tar.gz && mv -f /etc/vdr/channels-w_scan2-Thor.conf.tar.gz /home/`logname`/Vdrrepo/; echo "Channell list installed"; sleep 2;;
# m) echo "$MONO5W" >> /etc/vdr/diseqc.conf && sed -i 's/DiSEqC = 1/DiSEqC = 0/' /etc/vdr/setup.conf && cd /etc/vdr/ && wget https://www.dropbox.com/s/vt0wxz86c3x6y1n/channels-w_scan2-Eutelsat5.tar.gz && cp -rf /etc/vdr/channels-w_scan2-Eutelsat5.tar.gz /home/`logname`/Vdrrepo/ && tar -zxvf channels-w_scan2-Eutelsat5.tar.gz && rm -rf channels-w_scan2-Eutelsat5.tar.gz;;
n) echo "$MONO30W" >> /etc/vdr/diseqc.conf && sed -i 's/DiSEqC = 1/DiSEqC = 0/' /etc/vdr/setup.conf && cd /etc/vdr/ && wget https://www.dropbox.com/s/vt0wxz86c3x6y1n/channels-w_scan2-Eutelsat5.tar.gz && tar -zxvf channels-w_scan2-Eutelsat5.tar.gz && mv -f /etc/vdr/channels-w_scan2-Eutelsat5.tar.gz /home/`logname`/Vdrrepo/;;
z);;
esac
#
clear
echo "                *** Create Eventircd start command line (if installed)***"; sleep 2
if [ -f /usr/sbin/eventlircd ];
then
rm -rf /etc/init.d/eventlircd; touch /etc/init.d/eventlircd
echo '#!/bin/sh
#
# To be copied to: /etc/init.d
# And type:
### BEGIN INIT INFO
# Provides:          Eventlircd
# Required-Start:
# Required-Stop:
# Default-Start:     0 1 2 3 4 5 6
# Default-Stop:
# Description:       Start, Stop or Restart Eventlircd
### END INIT INFO

# Shell functions sourced from /etc/rc.status:
set -e

# Reset status of this service
# rc_reset
#
echo "Eventlircd init.d script using: $1" >> /var/log/eventlircd.log &
case "$1" in
    start)
        echo -n "Start Eventlircd "
        rm -rf /var/run/lirc/lircd
	mkdir -p /var/run/lirc
       /usr/sbin/eventlircd -e /etc/eventlircd.d
        # Remember status and be verbose
        ;;
    stop)
        echo -n "Kill Eventlircd "
       killall -9 eventlircd
        # Remember status and be verbose
        ;;
    restart)
        echo -n "Restart Eventlircd"
        $0 stop
        $0 start

        # Remember status and be quiet
        ;;
    *)
        echo "Usage: $0 {start|stop|restart}"
        exit 1
        ;;
esac
exit 0
' >> /etc/init.d/eventlircd; chmod 755 /etc/init.d/eventlircd
touch /etc/sudoers.d/eventlircd
sed -i "s|%`logname` ALL=NOPASSWD: /etc/init.d/eventlircd||" /etc/sudoers.d/eventlircd
echo "%`logname` ALL=NOPASSWD: /etc/init.d/eventlircd" >> /etc/sudoers.d/eventlircd
sed -i "s|eventlircd ALL=(ALL) ALL||" /etc/sudoers.d/eventlircd
echo "eventlircd ALL=(ALL) ALL" >> /etc/sudoers.d/eventlircd
#
rm -rf /usr/local/bin/start-eventlircd.sh; touch /usr/local/bin/start-eventlircd.sh
echo '#!/bin/sh

sudo /etc/init.d/eventlircd start > /dev/null 2>&1' >> /usr/local/bin/start-eventlircd.sh
chmod 755 /usr/local/bin/start-eventlircd.sh
#
else echo "Eventlircd is not installed"
fi
#
sleep 1
clear
    dialog --title "   ** Setup remote **   " --infobox "
   ----------------------------------------------
        Setup remote Lirc / Eventlircd
   ----------------------------------------------
		LIRC

        [a]    Mce
        [b]    Hama-Mce
        [c]    Hauppauge
        [d]    Mce-Spinel remote
        [e]    Vdr Manual

		EVENTLIRC

        [f]    Custom Eventlircd remote

        [z]    Skip

    ---------------------------------------------- " 0 0
echo -n "        Enter your menu choice  [a-z]:      "
read yourch
case $yourch in

a) clear; cd /etc/vdr; wget https://www.dropbox.com/s/hsp66258srhwa1d/mce-remote.conf.tar.gz; tar -zxvf mce-remote.conf.tar.gz; mv -f mce-remote.conf.tar.gz /home/`logname`/Vdrrepo/;;
b) clear; cd /etc/vdr; wget https://www.dropbox.com/s/gjjsn2h32mlqm4i/New-hama-mce-remote.conf.tar.gz; tar -zxvf New-hama-mce-remote.conf.tar.gz; mv rf New-hama-mce-remote.conf.tar.gz /home/`logname`/Vdrrepo/;;
c) clear; cd /etc/vdr; wget https://www.dropbox.com/s/gvel64ykd3eyx07/hauppauge-remote.conf.tar.gz; tar -zxvf hauppauge-remote.conf.tar.gz; mv -f /etc/vdr/hauppauge-remote.conf.tar.gz /home/`logname`/Vdrrepo/;;
d) clear; cd /etc/vdr; wget https://www.dropbox.com/s/t64duomj9f5hkqp/mce-spinel.remote.conf.tar.gz; tar -zxvf mce-spinel.remote.conf.tar.gz; mv -f /etc/vdr/mce-spinel.remote.conf.tar.gz /home/`logname`/Vdrrepo/;;
e) clear; cd /etc/vdr; rm -rf remote.conf; touch remote.conf;;
f) clear; cd /etc/vdr; wget https://www.dropbox.com/s/twximoeme4uwu8f/eventlircd-remote.conf.tar.gz; tar -zxvf eventlircd-remote.conf.tar.gz; mv -f /etc/vdr/eventlircd-remote.conf.tar.gz /home/`logname`/Vdrrepo/;;
z);;
esac
#
echo "                    *** Oscam Setup  ***"
sleep 2
cd /usr/local
mkdir -p etc
if [ -f /usr/local/etc/oscam.check ]
  then  echo "Oscam is already installed"
else
apt-get -y install libssl.dev libcrypto++-dev pcscd
cd $ETC
cp -rf /home/`logname`/Vdrrepo/oscam.tar.gz /$ETC/
tar -zxvf oscam.tar.gz
rm -rf oscam.tar.gz
cp -rf /home/`logname`/Vdrrepo/oscam64.tar.gz /usr/local/bin/
cd /usr/local/bin
tar -zxvf oscam64.tar.gz
rm -rf oscam64.tar.gz
chmod 777 oscam
fi
#
echo "                    *** Create Oscam start command line ***"
sleep 2
rm -rf /etc/init.d/oscam
touch /etc/init.d/oscam

echo '#!/bin/sh
#
# To be copied to: /etc/init.d
# And type:
### BEGIN INIT INFO
# Provides:          Oscam
# Required-Start:
# Required-Stop:
# Default-Start:     0 1 2 3 4 5 6
# Default-Stop:
# Description:       Start, Stop or Restart Oscam
### END INIT INFO

# Shell functions sourced from /etc/rc.status:
set -e

# Reset status of this service
# rc_reset
#
echo "Vdr init.d script using: $1" >> /var/log/oscam.log &
case "$1" in
    start)
        echo -n "Start Oscam "
       /usr/local/bin/oscam >> /var/log/oscam.log &
        # Remember status and be verbose
        ;;
    stop)
        echo -n "Kill Oscam "
       killall -9 oscam
        # Remember status and be verbose
        ;;
    restart)
        echo -n "Restart Oscam "
        $0 stop
        $0 start

        # Remember status and be quiet
        ;;
    *)
        echo "Usage: $0 {start|stop|restart}"
        exit 1
        ;;
esac
exit 0
' >> /etc/init.d/oscam
chmod 755 /etc/init.d/oscam
#
echo "                    *** Setup Oscam icon  ***"
sleep 1
rm -rf /home/`logname`/Scrivania/Oscam.desktop
rm -rf /usr/share/applications/Oscam.desktop
touch /usr/share/applications/Oscam.desktop
echo "[Desktop Entry]
Version=1.0
Encoding=UTF-8
Type=Application
Name=Oscam
Description=Oscam Start
Icon=/usr/local/src/icone/Oscam.png
Exec=/usr/local/bin/start-oscam.sh
" >> /usr/share/applications/Oscam.desktop
chmod 777 /usr/share/applications/Oscam.desktop
#
rm -rf /usr/local/bin/start-oscam.sh
touch /usr/local/bin/start-oscam.sh
echo '#!/bin/sh
sleep 10
sudo /etc/init.d/oscam start > /dev/null 2>&1
' >> /usr/local/bin/start-oscam.sh
chmod 777 /usr/local/bin/start-oscam.sh
touch /etc/sudoers.d/kodi
sed -i "s|kodi ALL=(ALL) ALL||" /etc/sudoers.d/kodi
echo "kodi ALL=(ALL) ALL" >> /etc/sudoers.d/kodi
#
echo "                    *** Setup Kill Oscam icon  ***"
sleep 1
rm -rf /home/`logname`/Scrivania/KillOscam.desktop
rm -rf /usr/share/applications/KillOscam.desktop
touch /usr/share/applications/KillOscam.desktop
echo "[Desktop Entry]
Version=1.0
Encoding=UTF-8
Type=Application
Name=KillOscam
Description=Kill Oscam
Icon=/usr/local/src/icone/killoscam.png
Exec=/usr/local/bin/KillOscam.sh
" >> /usr/share/applications/KillOscam.desktop
chmod 777 /usr/share/applications/KillOscam.desktop
#
rm -rf /usr/local/bin/KillOscam.sh
touch /usr/local/bin/KillOscam.sh
echo '#!/bin/sh

sudo /etc/init.d/oscam stop > /dev/null 2>&1
' >> /usr/local/bin/KillOscam.sh
chmod 777 /usr/local/bin/KillOscam.sh
#
echo "                    Configuring Skindesigner"
sleep 1
cd /usr/lib/vdr/skindesigner/scripts/
ln -s temperatures.default temperatures
ln -s vdrstats.default vdrstats
cd /home/`logname`/Vdrrepo/
chmod -R 777 *
#
echo "                    Configuring Iptv"
sleep 1
sed -i 's/geteuid/getppid/' /usr/bin/vlc
cp -rf /home/`logname`/Vdrrepo/iptv_conf.tar.gz /$PLUGINS/iptv/
cd /$PLUGINS/iptv/
rm -rf vlc2iptv
tar -zxvf iptv_conf.tar.gz
rm -rf iptv_conf.tar.gz
#
echo "                    *** Permission to execute Vdr - Oscam  ***"
sleep 1
touch /etc/sudoers.d/vdr
touch /etc/sudoers.d/oscam
sed -i "s|vdr ALL=(ALL) ALL||" /etc/sudoers.d/vdr
echo "vdr ALL=(ALL) ALL" >> /etc/sudoers.d/vdr
sed -i "s|oscam ALL=(ALL) ALL||" /etc/sudoers.d/oscam
echo "oscam ALL=(ALL) ALL" >> /etc/sudoers.d/oscam
sed -i "s|%`logname` ALL=NOPASSWD: /etc/init.d/vdr||" /etc/sudoers.d/vdr
echo "%`logname` ALL=NOPASSWD: /etc/init.d/vdr" >> /etc/sudoers.d/vdr
sed -i "s|%`logname` ALL=NOPASSWD: /etc/init.d/oscam||" /etc/sudoers.d/oscam
echo "%`logname` ALL=NOPASSWD: /etc/init.d/oscam" >> /etc/sudoers.d/oscam
#
apt-mark hold lirc lirc-x
apt-mark hold ffmpeg
apt-mark hold vdr
#
echo "                    *** Installation completed ***"
#
sleep 2
#
killall -9 vdr
#
/usr/local/bin/start-vdr.sh;;
esac;;

#############################################################

4)

clear
echo "                    *** Install W_scan_cpp ***"
sleep 1
cd $SRC
apt-get -y install libcurl4-openssl-dev git libpugixml-dev ca-certificates
if [ -d /usr/local/src/librepfunc ]
	then echo "librepfunc $Remind3"; sleep 3
		else git clone https://github.com/wirbel-at-vdr-portal/librepfunc.git
        cd librepfunc
		make -j8
		make install
        fi
if [ -f /usr/local/bin/w_scan_cpp ]
    then echo "W_scan_cpp $Remind3"; sleep 3
        else wget https://www.gen2vdr.de/wirbel/w_scan_cpp/w_scan_cpp-20211212.tar.bz2
        tar xjf w_scan_cpp-20211212.tar.bz2
        mv -f w_scan_cpp-20211212 w_scan_cpp
        cd w_scan_cpp
        make download
        make
        make install
        rm -rf w_scan_cpp-20211212.tar.bz2
fi
#
echo "               *** Install W_scan2 ***"
sleep 1
cd $SRC
if [ -f /$SRC/w_scan2/Makefile ]
  then  echo "W_scan2 $emind3"
else git clone https://github.com/stefantalpalaru/w_scan2
cp w_scan2 /home/`logname`/Vdrrepo/
cd w_scan2
./autogen.sh
./configure
make && make install
fi
#
clear
    dialog --title "   ** Install && Upgrade Settings **   " --infobox "
   --------------------------------------------------------------
                     Setup channell list
   --------------------------------------------------------------


        ****   Sezione W_scan_cpp/t2scan  ****

        [a]    Install Settings Turksat - 42°E
        [b]    Install Settings Astra 4 - 4.8°E   # no
        [c]    Install Settings Eutelsat 9 - 9.0°E
        [d]    Install Settings Hotbird - 13.0°E
        [e]    Install Settings Astra 19 - 19.2°E
        [f]    Install Settings Astra 23.5 - 23.5°E
        [g]    Install Settings Astra 28 - 28.2°E   #?
        [h]    Install Settings Thor 0.8°W
        [i]    Install Settings Eutelsat 5 - 5°W    #no
        [l]    Install Settings Hispasat - 30°W
        [m]    Install Terrestrial Settings (Italy)

        [z]    Skip

   -------------------------------------------------------------- " 0 0
echo -n "        Enter your menu choice  [a-z]:      "
read yourch
case $yourch in

a) clear; rm -rf /etc/vdr/channels-w_scan_cpp-Turksat.conf; w_scan_cpp -fs -s S42E0 >> /etc/vdr/channels-w_scan_cpp-Turksat.conf;;
# b) clear; rm -rf /etc/vdr/channels-w_scan_cpp-Astra_4.conf; w_scan_cpp -fs -s S4E8 >> /etc/vdr/channels-w_scan_cpp-Astra_4.conf;;
c) clear; rm -rf /etc/vdr/channels-w_scan_cpp-Eutelsat_9.conf; w_scan_cpp -fs -s S9E0 >> /etc/vdr/channels-w_scan_cpp-Eutelsat_9.conf;;
d) clear; rm -rf /etc/vdr/channels-w_scan_cpp-Hotbird.conf; w_scan_cpp -fs -s S13E0 >> /etc/vdr/channels-w_scan_cpp-Hotbird.conf;;
e) clear; rm -rf /etc/vdr/channels-w_scan_cpp-Astra_19.conf; w_scan_cpp -fs -s S19E2 >> /etc/vdr/channels-w_scan_cpp-Astra_19.conf;;
f) clear; rm -rf /etc/vdr/channels-w_scan_cpp-Astra_23.conf; w_scan_cpp -fs -s S23E5 >> /etc/vdr/channels-w_scan_cpp-Astra_23.conf;;
# g) clear; clear; rm -rf /etc/vdr/channels-w_scan_cpp-Astra_28.conf; w_scan_cpp -fs -s S28E2 >> /etc/vdr/channels-w_scan_cpp-Astra_28.conf;;
h) clear; rm -rf /etc/vdr/channels-w_scan_cpp-Thor.conf; w_scan_cpp -fs -s S0W8 >> /etc/vdr/channels-w_scan_cpp-Thor.conf;;
# i) clear; rm -rf /etc/vdr/channels-w_scan_cpp-Eutelsat_5.conf; w_scan_cpp -fs -s S5W0 >> /etc/vdr/channels-w_scan2-Eutelsat_5.conf;;
l) clear; rm -rf /etc/vdr/channels-w_scan_cpp-Hispasat.conf; w_scan_cpp -fs -s S30W0 >> /etc/vdr/channels-w_scan_cpp-Hispasat.conf;;
m) clear; rm -rf /etc/vdr/channels-dtt.conf; w_scan2 -ft -c IT >> /etc/vdr/channels-dtt.conf;;

z) ;;
#
esac;;

#############################################################

5)
clear
    dialog --title "   ** Install & Setup KODI **   " --infobox "
   --------------------------------------------------------------
                         Install/Remove Kodi
   --------------------------------------------------------------

        *****  Install  *****  ..........  *****  Remove  *****
        [a]    Install  ............  [a1]    Remove KODI

        [z]    Skip


   -------------------------------------------------------------- " 0 0
echo -n "        Enter your menu choice = Install [a] ~~ Remove [a1] ~~ Exit [z]:      "
read yourch
case $yourch in

a)
clear
apt-get -y install software-properties-common pkg-config

clear
    dialog --title "   ** KODI **   " --infobox "
   ----------------------------------------------
                KODI versions
   ----------------------------------------------
        [a]    Kodi Stable version
        [b]    Kodi Release Candidate version
        [c]    Kodi Development version
        [d]    Kodi Old version

   ---------------------------------------------- " 0 0
    echo -n "        Enter your menu choice  [a-d]:      "
    read yourch
    case $yourch in

a)   clear; add-apt-repository ppa:team-xbmc/ppa; apt-get update; apt-get -y install kodi; apt install kodi-pvr-iptvsimple=3.9.8-1~focal;;
b)   clear; add-apt-repository ppa:team-xbmc/unstable; apt-get update;  apt-get -y install kodi; apt-get -y install kodi-pvr-iptvsimple;;
c)   clear; add-apt-repository ppa:team-xbmc/xbmc-nightly;  apt-get -y install kodi; apt-get -y install kodi-pvr-iptvsimple;;
d)   clear; add-apt-repository ppa:team-xbmc/kodi-old; apt-get -y install kodi; apt-get -y install kodi-pvr-iptvsimple; apt-mark hold kodi;;
esac
#
echo "                    *** Install Kodi Picon ***"
sleep 1
cd /usr/local/etc
wget https://www.dropbox.com/s/nntbowyed3m37tl/kodi_picon.tar.gz
cp -rf /usr/local/etc/kodi_picon.tar.gz /home/`logname`/Vdrrepo/
tar -zxvf kodi_picon.tar.gz
rm -rf kodi_picon.tar.gz

echo "                    Press Enter to continue ...               "
read enterKey;;

#############################################################

a1)

clear
echo "                    Remove KODI"
sleep 3
apt-get remove kodi*
apt-get purge kodi*
rm -rf ~/.kodi/
rm -rf /home/`logname`/.kodi/*
rm -rf /usr/share/kodi
add-apt-repository --remove ppa:team-xbmc/xbmc-nightly -y
add-apt-repository --remove ppa:team-xbmc/ppa -y
add-apt-repository --remove ppa:team-xbmc/unstable -y
rm -rf /home/`logname`/Scrivania/Kodi.desktop
rm -rf /usr/share/applications/Kodi.desktop;;
esac;;

#############################################################

6)                                        #########################################
                                          #                Exit/Stop              #
                                          #########################################


    clear
    echo ""
    echo ""
    echo ""
    echo ""
    echo "                                             .-----,        ,.----."
    echo "                                      .-----'       '------'       ',"
    echo "                                    ,'  First ed. by mona66 ® 2010   ',"
    echo "                                    '     Updated and Revision        '"
    echo "                                    ',  by fiveten_59 ® and knap ®    ,'"
    echo "                                     ,'   2013 ~ 2014 ~ 2015 ~ 2016      ',"
    echo "                                   '         vdr_git_installer         '"
    echo "                                    ',        by fiveten_59 ®         '"
    echo "                                    ',               2022           ,'"
    echo "                                      '----,      ,----,       ,----'"
    echo "                                            '----'      '-----'"
    echo "                                                      O"
    echo "                                                      o "
    echo "                                                        o  "
    echo "                                                       °"
    echo "                                                        °"
    echo "                                                      .88888888:.          "
    echo "                                                    88888888.88888.          "
    echo "                                                  .8888888888888888.          "
    echo "                                                  888888888888888888          "
    echo "                                                  88'..'888'..'88888          "
    echo "                                                  88'  '888'  '88888          "
    echo "                                                  88'..':::'..':8888          "
    echo "                                                  88:::,::,:::::8888          "
    echo "                                                  88':::::::::''8888          "
    echo "                                                 .88  '::::'    8:88.          "
    echo "                                                8888            '8:888.          "
    echo "                                              .8888'             '888888.          "
    echo "                                             .8888:..  .::.  ...:'8888888:.          "
    echo "                                            .8888.'     :'     ''::'88:88888          "
    echo "                                           .8888        '         '.888:8888.          "
    echo "                                          888:8         .           888:88888          "
    echo "                                        .888:88        .:           888:88888:          "
    echo "                                        8888888.       ::           88:888888          "
    echo "                                        '.::.888.      ::          .88888888          "
    echo "                                       .::::::.888.    ::         :::'8888'.:.          "
    echo "                                      ::::::::::.888   '         .::::::::::::          "
    echo "                                      ::::::::::::.8    '      .:8::::::::::::.          "
    echo "                                    .::::::::::::::.        .:888:::::::::::::          "
    echo "                                    :::::::::::::::88:.__..:88888:::::::::::'          "
    echo "                                     ''.:::::::::::88888888888.88:::::::::'          "
    echo "                                           '':::_:' -- '' -'-' '':_::::''          "
    echo ""
    echo "                                           Thanks to all and Have fun :-)"
    echo "                                                               "
    echo ""
    exit 0

;;
*) ;;
esac
done
