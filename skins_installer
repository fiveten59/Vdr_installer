#!/bin/bash
############################## !!! IMPORTANTE !!! #######################################
#                                                                                       #
# Script name : Skin_installer                                                          #
# Version: Github Repository Master (https://github.com/fiveten59/skin_installer)       #
#                                                                                       #
# chmod the script                                                                      #
# then load it simply typing: sudo ./skin_installer                                     #
#                                                                                       #
#########################################################################################
#                                                                                                                  
#
#REPO='home/'logname'/sifinstallrepo'
ETC='/usr/local/etc'
SRC='/usr/local/src'
VDRSRC=''$SRC'/vdr/PLUGINS/src'
LIB='/usr/local/lib/vdr/plugins'
PLUGINS='/etc/vdr/plugins'
SKIN='/etc/vdr/plugins/text2skin'
Remind='is already installed'
Remind1='Removed'
Remind4='are already installed'
Remind5='is not installed'
#
#
#echo "*** Install libraries ***"; 
    clear
    dialog --title "   ** Install libraries **   " --infobox "
   ----------------------------------------------

        [a]    O.S. Ubuntu 16.04                
        [b]    Libraries are already installed 
        [c]    Skip                                               
                                       
   ---------------------------------------------- " 0 0
    echo -n "        Enter your menu choice  [a-c]:      "
    read yourch
    case $yourch in
	a) apt-get -y install build-essential checkinstall libfreetype6-dev libfontconfig1-dev libjpeg62-dev libcap-dev libfribidi-dev libncurses5-dev libncursesw5-dev git-core gettext; apt-get -y install libx11-xcb-dev libxcb-dpms0-dev libxcb-glx0-dev libxcb-randr0-dev libxcb-screensaver0-dev libxcb-xv0-dev libxcb-image0-dev libxcb-util0-dev libxcb-icccm4-dev libxcb-keysyms1-dev libxcb-ewmh-dev; apt-get -y install libpcre++0 libpcre++-dev python-libxml2 python-libxslt1 python-pycurl python-simplejson mimms libxml2-dev python-all-dev python-central cdbs libglib2.0-dev debhelper txt2man;apt-get -y install libcurl3 libcurl4-gnutls-dev cvs libxcb-icccm4 libxcb-icccm4-dev libx11-xcb-dev libxcb-screensaver0-dev libxcb-dpms0-dev libmagick++-dev ;;
	b) ;;
	c) ;;
esac
#
#
# echo  "   ** Install VDR skins **   "  
    clear        
    dialog --title "   ** Install VDR skins  **   " --infobox "
   ----------------------------------------------
    Install VDR skins             
   ----------------------------------------------

        Basic_skin/CoolHD/Anthra/NarrowHD
        Skinsoppalusikka
        Skin Enigma
        Skin EgalT2
        Skin-Nopacity
        Skin Elchi

   ---------------------------------------------- " 0 0                 
echo "     Press Enter to continue ...    " ;read enterKey
#
#echo "*** Basic_skin/CoolHD/Anthra need Vdr-Plugin-Text2skin ***";
# 
    clear
    dialog --title "   ** Basic_skin/CoolHD/Anthra/NarrowHd skins need Vdr-Plugin-Text2skin **   " --infobox "
   ----------------------------------------------

        [a]    Install Basic_skin/CoolHD/Anthra skins
        [b]    Remove Basic_skin/CoolHD/Anthra skins            
        [c]    Skip 

   ---------------------------------------------- " 0 0  

    echo -n "        Enter your menu choice  [a-c]:      "
    read yourch
    case $yourch in               
a) cd $VDRSRC && if [ -f text2skin/Makefile ];
  then  echo "Text2skin $Remind"
  else apt-get -y install libgraphicsmagick++1-dev && git clone git://projects.vdr-developer.org/vdr-plugin-text2skin.git && cp -rf vdr-plugin-text2skin /home/`logname`/sifinstallrepo/ && mv vdr-plugin-text2skin text2skin && cd text2skin && wget https://www.dropbox.com/s/h2114fton87spyh/patch_text2skin.tar.gz && cp -rf patch_text2skin.tar.gz /home/`logname`/sifinstallrepo/ && tar -zxvf patch_text2skin.tar.gz && rm -r patch_text2skin.tar.gz && patch -p1 < 10_text2skin_livebuffer.patch && patch -p1 < 11_text2skin_render.patch && patch -p1 < 17_text2skin_graphicsmagick.patch && cd ../../.. && make plugins && sed -i "s|-P'externalplayer'|& -P'text2skin'|" /usr/local/bin/vdrrun
    fi
mkdir -p /etc/vdr/plugins/text2skin;
cd /etc/vdr/themes;
if [ -f /etc/vdr/themes/checkthemes ];
	then echo " Anthra Themes $Remind4"
		else wget https://www.dropbox.com/s/m32a4s23h7r00mg/themes.tar.gz && cp -rf themes.tar.gz /home/`logname`/sifinstallrepo/ && tar -zxvf themes.tar.gz && rm -r themes.tar.gz
fi
cd /etc/vdr/plugins/text2skin; 
if [ -f /etc/vdr/plugins/text2skin/checkanthra ];
	then echo " Anthra Skin $Remind"
		else wget https://www.dropbox.com/s/zwb0vp6gfwh7d4y/anthra_pack.tar.gz && cp -rf anthra_pack.tar.gz /home/`logname`/sifinstallrepo/ && tar -zxvf anthra_pack.tar.gz && rm -r anthra_pack.tar.gz
fi
#;
if [ -f /etc/vdr/plugins/text2skin/checkcool ];
	then echo " CoolHD Skin $Remind"
		else wget https://www.dropbox.com/s/66eowrn57bj74du/coolHD_0.2.tar.gz && cp -rf coolHD_0.2.tar.gz /home/`logname`/sifinstallrepo/ && tar -zxvf coolHD_0.2.tar.gz && rm -r coolHD_0.2.tar.gz
fi
#
if [ -f /etc/vdr/plugins/text2skin/Basic ];
	then echo " Basic Skin $Remind"
		else wget https://www.dropbox.com/s/y4jiosfxinkh2e1/Basic_skin.tar.gz && cp -rf Basic_skin.tar.gz /home/`logname`/sifinstallrepo/ && tar -zxvf Basic_skin.tar.gz && rm -r Basic_skin.tar.gz
fi
#
cd $VDRSRC && if [ -f narrowhd/Makefile ];
  	then  echo " NarrowHD Skin $Remind"
  		else git clone git://projects.vdr-developer.org/skin-narrowhd.git && cp -rf skin-narrowhd /home/`logname`/sifinstallrepo/ && mv skin-narrowhd narrowhd && cd narrowhd && make && make install && cd /etc/vdr/plugins/text2skin/NarrowHD/logos/ && rm -rf * && ln -s /etc/vdr/logos $SKIN/NarrowHD/logos
fi;
        echo "                    Press Enter to continue ...               "; read enterKey;;
b) cd $VDRSRC && rm -rf text2skin && rm-rf narrowhd && cd $PLUGINS && rm -rf text2skin && rm -rf $LIB/libvdr-text2skin.* && sed -i "s|-P'text2skin'||" /usr/local/bin/vdrrun && echo "Vdr-Plugin-Text2skin and Basic/CoolHD/Anthra Skins $Remind1 " ;
      echo "                    Press Enter to continue ...               "; read enterKey;; 
c) ;;
esac
#
#
#echo "*** Skinsoppalusikka Skin ***"; 
    clear
    dialog --title "   ** Skinsoppalusikka Skin **   " --infobox "
   ----------------------------------------------

        [a]    Install Skinsoppalusikka Skin
        [b]    Remove Skinsoppalusikka Skin                
        [c]    Skip             
                                       
   ---------------------------------------------- " 0 0
    echo -n "        Enter your menu choice  [a-c]:      "
    read yourch
    case $yourch in 
a) cd $VDRSRC  && if [ -f skinsoppalusikka/Makefile ];
  		then  echo "Skinsoppalusikka Skin $Remind"
			else git clone https://github.com/rofafor/vdr-plugin-skinsoppalusikka.git && cp -rf vdr-plugin-skinsoppalusikka /home/`logname`/sifinstallrepo/ && mv vdr-plugin-skinsoppalusikka skinsoppalusikka && cd ../.. && make plugins && sed -i "s|-P'externalplayer'|& -P'skinsoppalusikka'|" /usr/local/bin/vdrrun
	fi;
        echo "                    Press Enter to continue ...               "; read enterKey;;  
b) cd $VDRSRC && if [ -f skinsoppalusikka/Makefile ];
  	then rm -r $VDRSRC/skinsoppalusikka && rm -rf /etc/vdr/plugins/skinsoppalusikka && rm -rf $LIB/libvdr-skinsoppalusikka.* && sed -i "s|-P'skinsoppalusikka'||" /usr/local/bin/vdrrun && echo "Skinsoppalusikka Skin $Remind1"
  		else echo "Skinsoppalusikka Skin $Remind5" 
fi
        echo "                    Press Enter to continue ...               "; read enterKey;;  
c) ;;
esac
#
#
#echo "*** Enigma Skin ***"; && patch -p1 < 01_skinenigmang_Makefile.patch 
    clear
    dialog --title "   ** Enigma Skin **   " --infobox "
   ----------------------------------------------

        [a]    Install Enigma Skin
        [b]    Remove Enigma Skin                
        [c]    Skip             
                                       
   ---------------------------------------------- " 0 0
    echo -n "        Enter your menu choice  [a-c]:      "
    read yourch
    case $yourch in 
a) cd $VDRSRC && if [ -f skinenigmang/Makefile ];
  	then  echo "Skin Enigma $Remind"
  		else apt-get -y install libgraphicsmagick++1-dev && git clone http://projects.vdr-developer.org/git/vdr-plugin-skinenigmang.git && cp -rf vdr-plugin-skinenigmang /home/`logname`/sifinstallrepo/ && mv vdr-plugin-skinenigmang skinenigmang && cd skinenigmang && cp -rf themes/*.theme /etc/vdr/themes/ && wget https://www.dropbox.com/s/3ba9ryxvctmfqty/patch_skinenigmang.tar.gz && tar -zxvf patch_skinenigmang.tar.gz && cp -rf patch_skinenigmang.tar.gz /home/`logname`/sifinstallrepo/ && rm -rf patch_skinenigmang.tar.gz && patch -p1 < 02_skinenigmang_min_max_from_stl.patch && cd ../../.. && make plugins && cd /etc/vdr/plugins && mkdir -p skinenigmang && cd skinenigmang && wget https://www.dropbox.com/s/odv30s0a22mau60/skinenigmang-logos-xpm-hi-20070702.tgz && cp -rf skinenigmang-logos-xpm-hi-20070702.tgz /home/`logname`/sifinstallrepo/ && wget https://www.dropbox.com/s/weh6c53bg9363ey/skinenigmang-channellogos-xpm-hi-20070702.tgz && cp -rf skinenigmang-channellogos-xpm-hi-20070702.tgz /home/`logname`/sifinstallrepo/ && wget https://www.dropbox.com/s/pydva1r0iafh5hy/skinenigmang-fonts-20080225.tgz && cp -rf skinenigmang-fonts-20080225.tgz /home/`logname`/sifinstallrepo/ && tar xzvf skinenigmang-channellogos-xpm-hi-20070702.tgz && tar xzvf skinenigmang-fonts-20080225.tgz && tar xzvf skinenigmang-fonts-20080225.tgz && rm -r skinenigmang-channellogos-xpm-hi-20070702.tgz && rm -r skinenigmang-fonts-20080225.tgz && rm -r skinenigmang-logos-xpm-hi-20070702.tgz && sed -i "s|-P'dvbapi'|& -P'skinenigmang'|" /usr/local/bin/vdrrun 
fi;
      echo "                    Press Enter to continue ...               "; read enterKey;;
b) cd $VDRSRC && if [ -f skinenigmang/Makefile ];
  	then rm -r $VDRSRC/skinenigmang && rm -rf $LIB/libvdr-skinenigmang.* && sed -i "s|-P'skinenigmang'||" /usr/local/bin/vdrrun && echo "Enigma Skin $Remind1"
		else echo "Enigma Skin $Remind5" 
fi;
      echo "                    Press Enter to continue ...               "; read enterKey;;  
c) ;;
esac
#    
#    
#echo "*** EgalT2 Skin ***"; 
    clear
    dialog --title "   ** EgalT2 Skin **   " --infobox "
   ----------------------------------------------

        [a]    Install EgalT2 Skin
        [b]    Remove EgalT2 Skin                
        [c]    Skip             
                                       
   ---------------------------------------------- " 0 0
    echo -n "        Enter your menu choice  [a-c]:      "
    read yourch
    case $yourch in 
a) cd $VDRSRC && if [ -f EgalT2/Makefile ];
  	then  echo "EgalT2 $Remind"
  		else wget https://www.dropbox.com/s/knps7b8q2udary6/vdr-text2skin-EgalT2-0.3.3.tar.gz && cp -rf vdr-text2skin-EgalT2-0.3.3.tar.gz /home/`logname`/sifinstallrepo/ && tar -zxvf vdr-text2skin-EgalT2-0.3.3.tar.gz && rm -rf vdr-text2skin-EgalT2-0.3.3.tar.gz && cd EgalT2 && make install && cd .. 
fi;
      echo "                    Press Enter to continue ...               "; read enterKey;;
b) cd $VDRSRC && if [ -f EgalT2/Makefile ];
  	then rm -r $VDRSRC/EgalT2 && echo "EgalT2 Skin $Remind1" 
		else echo "EgalT2 Skin $Remind5" 
fi;
      echo "                    Press Enter to continue ...               "; read enterKey;; 
c) ;;
esac
#    
#    
#echo "*** Skin-Nopacity***"; 
    clear
    dialog --title "   ** Skin-Nopacity **   " --infobox "
   ----------------------------------------------

        [a]    Install Skin-Nopacity
        [b]    Remove Skin-Nopacity                
        [c]    Skip             
                                       
   ---------------------------------------------- " 0 0
    echo -n "        Enter your menu choice  [a-c]:      "
    read yourch
    case $yourch in 
a) cd $VDRSRC && if [ -f skin-nopacity/Makefile ];
  	then  echo "Skin-Nopacity $Remind"
  		else git clone https://projects.vdr-developer.org/git/skin-nopacity.git && cp -rf skin-nopacity /home/`logname`/sifinstallrepo/ && cd skin-nopacity && wget https://www.dropbox.com/s/hegz319loovpb4r/patch_skinnopacity.tar.gz && tar -zxvf patch_skinnopacity.tar.gz && cp -rf patch_skinnopacity.tar.gz /home/`logname`/sifinstallrepo/ && rm -r patch_skinnopacity.tar.gz && patch -p1 < 11_skinnopacity_displaychannel.c.patch && patch -p1 < 12_skinnopacity_lib_Magick.patch && patch -p1 < 12_skinnopacity_vdr233.patch && patch -p1 < 13_skinnopacity_min_max_from_stl.patch && patch -p1 < skinnopacity_vdr-2.3.8.patch && make install && cd ../../.. && make plugins && sed -i "s|-P'externalplayer'|& -P'skinnopacity -l /etc/vdr/logos/'|" /usr/local/bin/vdrrun 
fi;
      echo "                    Press Enter to continue ...               "; read enterKey;;
b) cd $VDRSRC && if [ -f skin-nopacity/Makefile ];
  	then rm -rf $VDRSRC/skin-nopacity && rm -rf $LIB/libvdr-skinnopacity.* && sed -i "s|-P'skinnopacity -l /etc/vdr/logos/'||" /usr/local/bin/vdrrun && echo "Skin Nopacity $Remind1"
		else echo "Skin Nopacity $Remind5" 
fi;
      echo "                    Press Enter to continue ...               "; read enterKey;;  
c) ;;
esac
#
#    
#echo "*** SkinElchi ***"; 
    clear
    dialog --title "   ** SkinElchi **   " --infobox "
   ----------------------------------------------

        [a]    Install SkinElchi
        [b]    Remove SkinElchi               
        [c]    Skip             
                                       
   ---------------------------------------------- " 0 0
    echo -n "        Enter your menu choice  [a-c]:      "
    read yourch
    case $yourch in 
a) cd $VDRSRC && if [ -f skinelchi/Makefile ];
  	then  echo "SkinElchi $Remind"
  		else wget http://firefly.vdr-developer.org/skinelchi/vdr-skinelchi-0.3.0.tar.bz2 && cp -rf vdr-skinelchi-0.3.0.tar.bz2 /home/`logname`/sifinstallrepo/ && tar xjf vdr-skinelchi-0.3.0.tar.bz2 && rm -r vdr-skinelchi-0.3.0.tar.bz2 && mv skinelchi-0.3.0 skinelchi && cd skinelchi && cp -rf themes/* /etc/vdr/themes/ && wget https://www.dropbox.com/s/61z03hw3yrrjh8i/patch_skinelchi.tar.gz && tar -zxvf patch_skinelchi.tar.gz && cp -rf patch_skinelchi.tar.gz /home/`logname`/sifinstallrepo/ && patch -p1 < vdr-plugin-skinelchi.patch  && cd ../../.. && make plugins && sed -i "s|-P'externalplayer'|& -P'skinelchi -l /etc/vdr/logos/'|" /usr/local/bin/vdrrun  
fi;
      echo "                    Press Enter to continue ...               "; read enterKey;;
b) cd $VDRSRC && if [ -f skinelchi/Makefile ];
  	then rm -rf $VDRSRC/skinelchi && rm -rf $LIB/libvdr-skinelchi.* && sed -i "s|-P'skinelchi -l /etc/vdr/logos/'||" /usr/local/bin/vdrrun  && echo "Skin Elchi $Remind1" 
		else echo "SkinElchi $Remind5" 
fi;
      echo "                    Press Enter to continue ...               "; read enterKey;; 
c) ;;
esac
#
#
apt-get -y install libgraphicsmagick++1-dev
cd /home/`logname`/sifinstallrepo/; chmod -R 777 *;
#
cd $SRC/vdr; make plugins install;

    

    clear
    echo ""
    echo ""
    echo ""
    echo ""
    echo "                                                       .-----,        ,.----."
    echo "                                                .-----'       '------'       ',"
    echo "                                              ,'                              ',"
    echo "                                              '           Skin_installer        ,"
    echo "                                              ',             First ed.        ,'"
    echo "                                              ,'          by fiveten_59 ®      ',"
    echo "                                             '                 2017           ,"
    echo "                                              ',                               ,'"
    echo "                                              ',                                ,'"
    echo "                                                '----,      ,----,       ,----'"
    echo "                                                      '----'      '-----'"
    echo "                                                                O"
    echo "                                                                 o "
    echo "                                                                  o  "
    echo "                                                                   °"
    echo "                                                                    °"
    echo "                                                                .88888888:.          "
    echo "                                                              88888888.88888.          "
    echo "                                                            .8888888888888888.          "
    echo "                                                            888888888888888888          "
    echo "                                                            88'..'888'..'88888          "
    echo "                                                            88'  '888'  '88888          "
    echo "                                                            88'..':::'..':8888          "
    echo "                                                            88:::,::,:::::8888          "
    echo "                                                            88':::::::::''8888          "
    echo "                                                           .88  '::::'    8:88.          "
    echo "                                                          8888            '8:888.          "
    echo "                                                        .8888'             '888888.          "
    echo "                                                       .8888:..  .::.  ...:'8888888:.          "
    echo "                                                      .8888.'     :'     ''::'88:88888          "
    echo "                                                     .8888        '         '.888:8888.          "
    echo "                                                    888:8         .           888:88888          "
    echo "                                                  .888:88        .:           888:88888:          "
    echo "                                                  8888888.       ::           88:888888          "
    echo "                                                  '.::.888.      ::          .88888888          "
    echo "                                                 .::::::.888.    ::         :::'8888'.:.          "
    echo "                                                ::::::::::.888   '         .::::::::::::          "
    echo "                                                ::::::::::::.8    '      .:8::::::::::::.          "
    echo "                                              .::::::::::::::.        .:888:::::::::::::          "
    echo "                                              :::::::::::::::88:.__..:88888:::::::::::'          "
    echo "                                               ''.:::::::::::88888888888.88:::::::::'          "
    echo "                                                     '':::_:' -- '' -'-' '':_::::''          "
    echo ""
    echo "                                                     Grazie a tutti e buon divertimento"
    echo "                                                               Have fun :-)"
    echo ""
